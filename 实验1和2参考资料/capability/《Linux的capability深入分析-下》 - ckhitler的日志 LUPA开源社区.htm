<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0069)http://home.lupaworld.com/home-space-uid-56821-do-blog-id-234972.html -->
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xn="http://www.renren.com/2009/xnml" xmlns:og="http://ogp.me/ns#"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css"></style>

<title>《Linux的capability深入分析-下》 - ckhitler的日志   LUPA开源社区   </title>
<meta name="google-site-verification" content="Ae4q3uRfClhb1SWI2yZICMhnCK-4gY8U5q1ZQadJxUQ">
<meta name="keywords" content="Linux capability setcap">
<meta name="description" content="一)capability的工具介绍在我们的试验环境是RHEL6,libcap-2.16软件包中包含了相关的capability设置及查看工作,如下:rpm -ql libcap-2.16-5.2.el6.i686 ... ">
<meta name="generator" content="LUPA">
<meta name="author" content="LUPA">
<meta name="copyright" content="2001-2010 LUPA Inc.">
<meta name="MSSmartTagsPreventParsing" content="True">
<meta http-equiv="MSThemeCompatible" content="Yes">
<link rel="alternate" type="application/rss+xml" title="LUPA开源资讯" href="http://www.lupaworld.com/myrss.php">	
<!--<base href="http://home.lupaworld.com/">--><base href="."><link rel="stylesheet" type="text/css" href="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/style_3_common.css"><link rel="stylesheet" type="text/css" href="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/style_3_home_space.css"><link rel="stylesheet" id="css_extstyle" type="text/css" href="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/style.css"><script type="text/javascript">var STYLEID = '3', STATICURL = 'static/', IMGDIR = 'static/image/common', VERHASH = 'Q2H', charset = 'utf-8', discuz_uid = '0', cookiepre = 'l3xP_3b56_', cookiedomain = '.lupaworld.com', cookiepath = '/', showusercard = '1', attackevasive = '0', disallowfloat = 'newthread|reply', creditnotice = '1|LUPA币|点', defaultstyle = './template/default/style/t3', REPORTURL = 'aHR0cDovL2hvbWUubHVwYXdvcmxkLmNvbS9ob21lLXNwYWNlLXVpZC01NjgyMS1kby1ibG9nLWlkLTIzNDk3Mi5odG1s', SITEURL = 'http://home.lupaworld.com/';</script>
<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/common.js" type="text/javascript"></script><script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/home.js" type="text/javascript"></script>
<script type="text/javascript" src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/relatedItems.htm"></script><script type="text/javascript" charset="UTF-8" src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/dlg.js"></script><script type="text/javascript" charset="UTF-8" src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/xwb.js"></script></head><body id="nv_home" class="pg_space" onkeydown="if(event.keyCode==27) return false;"><link href="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/jiathis_share.css" rel="stylesheet" type="text/css"><div id="ckepop" style="height: auto; position: absolute; right: 0px; overflow-x: hidden; overflow-y: hidden; width: 26px; z-index: 1e+008; top: 956.9px; "><table cellpadding="0" cellspacing="0"><tbody style="background:transparent"><tr><td style="background:transparent"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/r1.gif" style="cursor:pointer;" onmouseover="$CKE.over()" onclick="$CKE.center(this)"></td><td><div><div class="jiadiv_01"><div style="width:100%;background:#F2F2F2;border-bottom:1px solid #E5E5E5;line-height:200%;padding-left:5px;font-size:12px"><table width="100%"><tbody><tr class="jt_sharetitle"><td align="left" style="text-align:left;line-height:25px;font-size:14px;font-weight:bold;color:#000000;">分享到...</td><td align="right" style="text-align:right;"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/img_exit.gif" border="0" style="opacity:0.5;filter:alpha(opacity=50);margin:0 10px;cursor:pointer;" onclick="$CKE.shareClose();"></td></tr></tbody></table></div><div class="jiadiv_02" style="width:100%;" id="jiathis_sers"><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;copy&#39;);return false;" class="jiatitle"><span class="jtico jtico_copy">复制网址</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;email&#39;);return false;" class="jiatitle"><span class="jtico jtico_email">邮件</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;qzone&#39;);return false;" class="jiatitle"><span class="jtico jtico_qzone">QQ空间</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tsina&#39;);return false;" class="jiatitle"><span class="jtico jtico_tsina">新浪微博</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;msn&#39;);return false;" class="jiatitle"><span class="jtico jtico_msn">MSN</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tqq&#39;);return false;" class="jiatitle"><span class="jtico jtico_tqq">腾讯微博</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;renren&#39;);return false;" class="jiatitle"><span class="jtico jtico_renren">人人网</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;kaixin001&#39;);return false;" class="jiatitle"><span class="jtico jtico_kaixin001">开心网</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;t163&#39;);return false;" class="jiatitle"><span class="jtico jtico_t163">网易微博</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tsohu&#39;);return false;" class="jiatitle"><span class="jtico jtico_tsohu">搜狐微博</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;xiaoyou&#39;);return false;" class="jiatitle"><span class="jtico jtico_xiaoyou">朋友网</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;taobao&#39;);return false;" class="jiatitle"><span class="jtico jtico_taobao">淘江湖</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;baidu&#39;);return false;" class="jiatitle"><span class="jtico jtico_baidu">百度搜藏</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;douban&#39;);return false;" class="jiatitle"><span class="jtico jtico_douban">豆瓣</span></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;ishare&#39;);return false;" class="jiatitle"><span class="jtico jtico_ishare">一键分享</span></a><a href="http://home.lupaworld.com/#" onclick="$CKE.center(this);return false;" class="jiatitle"><span class="jtico jtico_jiathis">查看更多(112)</span></a><div style="clear:both"></div></div><div class="ckepopBottom" style="width:100%;"><div style="float:left;font-size:10px"><a href="http://www.jiathis.com/help/html/what-is-jiathis" class="link_01" style="color:#333333;" target="_blank">这是什么工具?</a></div><div style="float:right;font-size:11px;margin:0 5px 0 0;"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/img_012.gif" align="absmiddle" border="0"><a href="http://www.jiathis.com/" style="color:#333333;padding:0 3px;" class="link_01" target="_blank">JiaThis</a></div><div style="clear:both"></div></div></div></div></td></tr></tbody></table></div><iframe style="position: absolute; display: none; " frameborder="0"></iframe><div id="ckepop" style="height: auto; position: absolute; z-index: 1e+008; top: 50%; left: 50%; overflow-x: auto; overflow-y: auto; display: none; "><div style="border:10px solid #7F7F7F; width:300px;"><div class="jiadiv_01" style="width:300px;"><div style="background:#F2F2F2;line-height:100%;height:30px;overflow:hidden;width:300px;"><table width="100%" style="margin:5px 0 0 0;"><tbody><tr class="jt_sharetitle" style="line-height:20px!important;"><td align="left" style="text-align:left;font-size:12px;">分享到各大网站</td><td align="right"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/img_exit.gif" border="0" style="margin:0 4px;cursor:pointer;" onclick="$CKE.centerClose();"></td></tr></tbody></table></div><div class="searchTxtCont"><div style="background:url(http://v2.jiathis.com/code/images/img_so.gif) no-repeat center;height:30px; width:281px"><input class="searchTxt" name="" type="text" onclick="this.value=&#39;&#39;;this.style.color=&#39;#000&#39;;" value="输入网站名或拼音缩写" onkeyup="$CKE.choose(this)"></div></div><div id="ckelist" class="jiadiv_02"><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;ishare&#39;);return false;" class="jiatitle"><span class="jtico jtico_ishare">一键分享</span><input type="hidden" value="ishare,一键分享,yjfx"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;copy&#39;);return false;" class="jiatitle"><span class="jtico jtico_copy">复制网址</span><input type="hidden" value="copy,复制网址,fzwz"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;fav&#39;);return false;" class="jiatitle"><span class="jtico jtico_fav">收藏夹</span><input type="hidden" value="fav,收藏夹,scj"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;print&#39;);return false;" class="jiatitle"><span class="jtico jtico_print">打印</span><input type="hidden" value="print,打印,dy"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;email&#39;);return false;" class="jiatitle"><span class="jtico jtico_email">邮件</span><input type="hidden" value="email,邮件,yj"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;qzone&#39;);return false;" class="jiatitle"><span class="jtico jtico_qzone">QQ空间</span><input type="hidden" value="qzone,QQ空间,qqkj"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tsina&#39;);return false;" class="jiatitle"><span class="jtico jtico_tsina">新浪微博</span><input type="hidden" value="tsina,新浪微博,xlwb"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tqq&#39;);return false;" class="jiatitle"><span class="jtico jtico_tqq">腾讯微博</span><input type="hidden" value="tqq,腾讯微博,txwb"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tsohu&#39;);return false;" class="jiatitle"><span class="jtico jtico_tsohu">搜狐微博</span><input type="hidden" value="tsohu,搜狐微博,shwb"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;t163&#39;);return false;" class="jiatitle"><span class="jtico jtico_t163">网易微博</span><input type="hidden" value="t163,网易微博,wywb"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;renren&#39;);return false;" class="jiatitle"><span class="jtico jtico_renren">人人网</span><input type="hidden" value="renren,人人网,rrw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;kaixin001&#39;);return false;" class="jiatitle"><span class="jtico jtico_kaixin001">开心网</span><input type="hidden" value="kaixin001,开心网,kxw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;sohu&#39;);return false;" class="jiatitle"><span class="jtico jtico_sohu">搜狐白社会</span><input type="hidden" value="sohu,搜狐白社会,shbsh"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;taobao&#39;);return false;" class="jiatitle"><span class="jtico jtico_taobao">淘江湖</span><input type="hidden" value="taobao,淘江湖,tjh"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;douban&#39;);return false;" class="jiatitle"><span class="jtico jtico_douban">豆瓣</span><input type="hidden" value="douban,豆瓣,db"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;xiaoyou&#39;);return false;" class="jiatitle"><span class="jtico jtico_xiaoyou">朋友网</span><input type="hidden" value="xiaoyou,朋友网,pyw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;mop&#39;);return false;" class="jiatitle"><span class="jtico jtico_mop">猫扑推客</span><input type="hidden" value="mop,猫扑推客,mptk"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;baidu&#39;);return false;" class="jiatitle"><span class="jtico jtico_baidu">百度搜藏</span><input type="hidden" value="baidu,百度搜藏,bdsc"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tieba&#39;);return false;" class="jiatitle"><span class="jtico jtico_tieba">百度贴吧</span><input type="hidden" value="tieba,百度贴吧,bdtb"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tianya&#39;);return false;" class="jiatitle"><span class="jtico jtico_tianya">天涯社区</span><input type="hidden" value="tianya,天涯社区,tysq"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;feixin&#39;);return false;" class="jiatitle"><span class="jtico jtico_feixin">飞信</span><input type="hidden" value="feixin,飞信,fx"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;qu1&#39;);return false;" class="jiatitle"><span class="jtico jtico_qu1">趣一网</span><input type="hidden" value="qu1,趣一网,qyw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tifeng&#39;);return false;" class="jiatitle"><span class="jtico jtico_tifeng">凤凰微博</span><input type="hidden" value="tifeng,凤凰微博,fhwb"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;youshi&#39;);return false;" class="jiatitle"><span class="jtico jtico_youshi">优士网</span><input type="hidden" value="youshi,优士网,ysw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;fanfou&#39;);return false;" class="jiatitle"><span class="jtico jtico_fanfou">饭否</span><input type="hidden" value="fanfou,饭否,ff"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;51&#39;);return false;" class="jiatitle"><span class="jtico jtico_51">51社区</span><input type="hidden" value="51,51社区,51sq"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;google&#39;);return false;" class="jiatitle"><span class="jtico jtico_google">谷歌</span><input type="hidden" value="google,谷歌,gg"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;buzz&#39;);return false;" class="jiatitle"><span class="jtico jtico_buzz">谷歌Buzz</span><input type="hidden" value="buzz,谷歌Buzz,ggbuzz"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;youdao&#39;);return false;" class="jiatitle"><span class="jtico jtico_youdao">有道书签</span><input type="hidden" value="youdao,有道书签,ydsq"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;qq&#39;);return false;" class="jiatitle"><span class="jtico jtico_qq">QQ书签</span><input type="hidden" value="qq,QQ书签,qqsq"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;msn&#39;);return false;" class="jiatitle"><span class="jtico jtico_msn">MSN</span><input type="hidden" value="msn,MSN,msn"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;sina&#39;);return false;" class="jiatitle"><span class="jtico jtico_sina">新浪vivi</span><input type="hidden" value="sina,新浪vivi,xlvivi"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;hi&#39;);return false;" class="jiatitle"><span class="jtico jtico_hi">百度空间</span><input type="hidden" value="hi,百度空间,bdkj"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;ifensi&#39;);return false;" class="jiatitle"><span class="jtico jtico_ifensi">粉丝网</span><input type="hidden" value="ifensi,粉丝网,fsw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;115&#39;);return false;" class="jiatitle"><span class="jtico jtico_115">115收藏</span><input type="hidden" value="115,115收藏,115sc"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;hexun&#39;);return false;" class="jiatitle"><span class="jtico jtico_hexun">和讯</span><input type="hidden" value="hexun,和讯,hx"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;gmail&#39;);return false;" class="jiatitle"><span class="jtico jtico_gmail">Gmail邮箱</span><input type="hidden" value="gmail,Gmail邮箱,gmailyx"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;hotmail&#39;);return false;" class="jiatitle"><span class="jtico jtico_hotmail">Hotmail邮箱</span><input type="hidden" value="hotmail,Hotmail邮箱,hotmailyx"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;ymail&#39;);return false;" class="jiatitle"><span class="jtico jtico_ymail">Yahoo! mail</span><input type="hidden" value="ymail,Yahoo! mail,yahoo! mail"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;139mail&#39;);return false;" class="jiatitle"><span class="jtico jtico_139mail">139邮箱</span><input type="hidden" value="139mail,139邮箱,139yx"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;189mail&#39;);return false;" class="jiatitle"><span class="jtico jtico_189mail">189邮箱</span><input type="hidden" value="189mail,189邮箱,189yx"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;i139&#39;);return false;" class="jiatitle"><span class="jtico jtico_i139">手机</span><input type="hidden" value="i139,手机,sj"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;189cn&#39;);return false;" class="jiatitle"><span class="jtico jtico_189cn">天翼社区</span><input type="hidden" value="189cn,天翼社区,tysq"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;139&#39;);return false;" class="jiatitle"><span class="jtico jtico_139">139说客</span><input type="hidden" value="139,139说客,139sk"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tpeople&#39;);return false;" class="jiatitle"><span class="jtico jtico_tpeople">人民微博</span><input type="hidden" value="tpeople,人民微博,rmwb"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;cnfol&#39;);return false;" class="jiatitle"><span class="jtico jtico_cnfol">中金微博</span><input type="hidden" value="cnfol,中金微博,zjwb"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;googlereader&#39;);return false;" class="jiatitle"><span class="jtico jtico_googlereader">谷歌阅读</span><input type="hidden" value="googlereader,谷歌阅读,ggyd"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;translate&#39;);return false;" class="jiatitle"><span class="jtico jtico_translate">谷歌翻译</span><input type="hidden" value="translate,谷歌翻译,ggfy"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tuita&#39;);return false;" class="jiatitle"><span class="jtico jtico_tuita">推他</span><input type="hidden" value="tuita,推他,tt"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;sdonote&#39;);return false;" class="jiatitle"><span class="jtico jtico_sdonote">麦库记事</span><input type="hidden" value="sdonote,麦库记事,mkjs"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;digu&#39;);return false;" class="jiatitle"><span class="jtico jtico_digu">嘀咕网</span><input type="hidden" value="digu,嘀咕网,dgw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;zhuaxia&#39;);return false;" class="jiatitle"><span class="jtico jtico_zhuaxia">抓虾</span><input type="hidden" value="zhuaxia,抓虾,zx"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;xianguo&#39;);return false;" class="jiatitle"><span class="jtico jtico_xianguo">鲜果</span><input type="hidden" value="xianguo,鲜果,xg"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;zuosa&#39;);return false;" class="jiatitle"><span class="jtico jtico_zuosa">做啥</span><input type="hidden" value="zuosa,做啥,zs"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;ganniu&#39;);return false;" class="jiatitle"><span class="jtico jtico_ganniu">赶牛网</span><input type="hidden" value="ganniu,赶牛网,gnw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;42qu&#39;);return false;" class="jiatitle"><span class="jtico jtico_42qu">42区</span><input type="hidden" value="42qu,42区,42q"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;woshao&#39;);return false;" class="jiatitle"><span class="jtico jtico_woshao">我烧网</span><input type="hidden" value="woshao,我烧网,wsw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;renjian&#39;);return false;" class="jiatitle"><span class="jtico jtico_renjian">人间网</span><input type="hidden" value="renjian,人间网,rjw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;leihou&#39;);return false;" class="jiatitle"><span class="jtico jtico_leihou">雷猴网</span><input type="hidden" value="leihou,雷猴网,lhw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;thexun&#39;);return false;" class="jiatitle"><span class="jtico jtico_thexun">和讯微博</span><input type="hidden" value="thexun,和讯微博,hxwb"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;dream163&#39;);return false;" class="jiatitle"><span class="jtico jtico_dream163">梦幻人生</span><input type="hidden" value="dream163,梦幻人生,mhrs"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;masar&#39;);return false;" class="jiatitle"><span class="jtico jtico_masar">玛撒网</span><input type="hidden" value="masar,玛撒网,msw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;renmaiku&#39;);return false;" class="jiatitle"><span class="jtico jtico_renmaiku">人脉库</span><input type="hidden" value="renmaiku,人脉库,rmk"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;fb&#39;);return false;" class="jiatitle"><span class="jtico jtico_fb">Facebook</span><input type="hidden" value="fb,Facebook,facebook"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;twitter&#39;);return false;" class="jiatitle"><span class="jtico jtico_twitter">Twitter</span><input type="hidden" value="twitter,Twitter,twitter"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tumblr&#39;);return false;" class="jiatitle"><span class="jtico jtico_tumblr">Tumblr</span><input type="hidden" value="tumblr,Tumblr,tumblr"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;reddit&#39;);return false;" class="jiatitle"><span class="jtico jtico_reddit">Reddit</span><input type="hidden" value="reddit,Reddit,reddit"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;instapaper&#39;);return false;" class="jiatitle"><span class="jtico jtico_instapaper">Instapaper</span><input type="hidden" value="instapaper,Instapaper,instapaper"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;readitlater&#39;);return false;" class="jiatitle"><span class="jtico jtico_readitlater">Read It Later</span><input type="hidden" value="readitlater,Read It Later,readitlater"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;diglog&#39;);return false;" class="jiatitle"><span class="jtico jtico_diglog">奇客发现</span><input type="hidden" value="diglog,奇客发现,qkfx"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;wealink&#39;);return false;" class="jiatitle"><span class="jtico jtico_wealink">若邻网</span><input type="hidden" value="wealink,若邻网,rlw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;bietiao&#39;);return false;" class="jiatitle"><span class="jtico jtico_bietiao">别挑</span><input type="hidden" value="bietiao,别挑,bt"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;leshou&#39;);return false;" class="jiatitle"><span class="jtico jtico_leshou">乐收</span><input type="hidden" value="leshou,乐收,ls"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;myspacecn&#39;);return false;" class="jiatitle"><span class="jtico jtico_myspacecn">聚友网</span><input type="hidden" value="myspacecn,聚友网,jyw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tongxue&#39;);return false;" class="jiatitle"><span class="jtico jtico_tongxue">同学网</span><input type="hidden" value="tongxue,同学网,txw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;waakee&#39;);return false;" class="jiatitle"><span class="jtico jtico_waakee">挖客网</span><input type="hidden" value="waakee,挖客网,wkw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;cyzone&#39;);return false;" class="jiatitle"><span class="jtico jtico_cyzone">创业邦</span><input type="hidden" value="cyzone,创业邦,cyb"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;99earth&#39;);return false;" class="jiatitle"><span class="jtico jtico_99earth">救救地球</span><input type="hidden" value="99earth,救救地球,jjdq"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;chouti&#39;);return false;" class="jiatitle"><span class="jtico jtico_chouti">抽屉网</span><input type="hidden" value="chouti,抽屉网,ctw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;dig24&#39;);return false;" class="jiatitle"><span class="jtico jtico_dig24">递客网</span><input type="hidden" value="dig24,递客网,dkw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;douban9dian&#39;);return false;" class="jiatitle"><span class="jtico jtico_douban9dian">豆瓣9点</span><input type="hidden" value="douban9dian,豆瓣9点,db9d"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;hemidemi&#39;);return false;" class="jiatitle"><span class="jtico jtico_hemidemi">黑米书签</span><input type="hidden" value="hemidemi,黑米书签,hmsq"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;meilishuo&#39;);return false;" class="jiatitle"><span class="jtico jtico_meilishuo">美丽说</span><input type="hidden" value="meilishuo,美丽说,mls"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;mogujie&#39;);return false;" class="jiatitle"><span class="jtico jtico_mogujie">蘑菇街</span><input type="hidden" value="mogujie,蘑菇街,mgj"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;tianji&#39;);return false;" class="jiatitle"><span class="jtico jtico_tianji">天际网</span><input type="hidden" value="tianji,天际网,tjw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;poco&#39;);return false;" class="jiatitle"><span class="jtico jtico_poco">Poco网</span><input type="hidden" value="poco,Poco网,pocow"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;baohe&#39;);return false;" class="jiatitle"><span class="jtico jtico_baohe">宝盒网</span><input type="hidden" value="baohe,宝盒网,bhw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;yijee&#39;);return false;" class="jiatitle"><span class="jtico jtico_yijee">易集网</span><input type="hidden" value="yijee,易集网,yjw"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;pdfonline&#39;);return false;" class="jiatitle"><span class="jtico jtico_pdfonline">Pdf在线转换</span><input type="hidden" value="pdfonline,Pdf在线转换,pdfzxzh"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;printfriendly&#39;);return false;" class="jiatitle"><span class="jtico jtico_printfriendly">友好打印</span><input type="hidden" value="printfriendly,友好打印,yhdy"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;w3c&#39;);return false;" class="jiatitle"><span class="jtico jtico_w3c">W3c验证</span><input type="hidden" value="w3c,W3c验证,w3cyz"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;bitly&#39;);return false;" class="jiatitle"><span class="jtico jtico_bitly">Bit.ly</span><input type="hidden" value="bitly,Bit.ly,bitly"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;digg&#39;);return false;" class="jiatitle"><span class="jtico jtico_digg">Digg</span><input type="hidden" value="digg,Digg,digg"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;mailru&#39;);return false;" class="jiatitle"><span class="jtico jtico_mailru">Mail.ru</span><input type="hidden" value="mailru,Mail.ru,mail.ru"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;diigo&#39;);return false;" class="jiatitle"><span class="jtico jtico_diigo">Diigo</span><input type="hidden" value="diigo,Diigo,diigo"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;evernote&#39;);return false;" class="jiatitle"><span class="jtico jtico_evernote">EverNote</span><input type="hidden" value="evernote,EverNote,evernote"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;friendfeed&#39;);return false;" class="jiatitle"><span class="jtico jtico_friendfeed">FriendFeed</span><input type="hidden" value="friendfeed,FriendFeed,friendfeed"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;myspace&#39;);return false;" class="jiatitle"><span class="jtico jtico_myspace">Myspace</span><input type="hidden" value="myspace,Myspace,myspace"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;linkedin&#39;);return false;" class="jiatitle"><span class="jtico jtico_linkedin">LinkedIn</span><input type="hidden" value="linkedin,LinkedIn,linkedin"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;mixx&#39;);return false;" class="jiatitle"><span class="jtico jtico_mixx">Mixx</span><input type="hidden" value="mixx,Mixx,mixx"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;netlog&#39;);return false;" class="jiatitle"><span class="jtico jtico_netlog">NetLog</span><input type="hidden" value="netlog,NetLog,netlog"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;netvibes&#39;);return false;" class="jiatitle"><span class="jtico jtico_netvibes">Netvibes</span><input type="hidden" value="netvibes,Netvibes,netvibes"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;phonefavs&#39;);return false;" class="jiatitle"><span class="jtico jtico_phonefavs">Phonefavs</span><input type="hidden" value="phonefavs,Phonefavs,phonefavs"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;pingfm&#39;);return false;" class="jiatitle"><span class="jtico jtico_pingfm">Ping.fm</span><input type="hidden" value="pingfm,Ping.fm,ping.fm"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;plaxo&#39;);return false;" class="jiatitle"><span class="jtico jtico_plaxo">Plaxo</span><input type="hidden" value="plaxo,Plaxo,plaxo"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;delicious&#39;);return false;" class="jiatitle"><span class="jtico jtico_delicious">Delicious</span><input type="hidden" value="delicious,Delicious,delicious"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;wong&#39;);return false;" class="jiatitle"><span class="jtico jtico_wong">Mister Wong</span><input type="hidden" value="wong,Mister Wong,misterwong"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;stumbleupon&#39;);return false;" class="jiatitle"><span class="jtico jtico_stumbleupon">Stumbleupon</span><input type="hidden" value="stumbleupon,Stumbleupon,stumbleupon"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;plurk&#39;);return false;" class="jiatitle"><span class="jtico jtico_plurk">Plurk</span><input type="hidden" value="plurk,Plurk,plurk"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;funp&#39;);return false;" class="jiatitle"><span class="jtico jtico_funp">Funp</span><input type="hidden" value="funp,Funp,funp"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;myshare&#39;);return false;" class="jiatitle"><span class="jtico jtico_myshare">Myshare</span><input type="hidden" value="myshare,Myshare,myshare"></a><a href="http://home.lupaworld.com/#" onclick="jiathis_sendto(&#39;fwisp&#39;);return false;" class="jiatitle"><span class="jtico jtico_fwisp">Fwisp</span><input type="hidden" value="fwisp,Fwisp,fwisp"></a><div style="clear:both"></div></div><div class="centerBottom"><div style="float:left;font-size:10px;"><a href="http://www.jiathis.com/help/html/what-is-jiathis" class="link_01" style="color:#333333;" target="_blank">这是什么工具?</a></div><div style="float:right;font-size:11px;margin:0 10px 0 0;"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/img_012.gif" align="absmiddle" border="none">&nbsp;<a href="http://www.jiathis.com/" style="color:#333333;" class="link_01" target="_blank">JiaThis</a></div><div style="clear:both"></div></div></div></div></div><iframe style="display: none; " frameborder="0" src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/jiathis_utility.htm"></iframe>
<div id="append_parent"><div id="ls_questionid_ctrl_menu" class="sltm" style="display: none; width: 131px; "><ul><li class="current">安全提问(未设置请忽略)</li><li>母亲的名字</li><li>爷爷的名字</li><li>父亲出生的城市</li><li>你其中一位老师的名字</li><li>你个人计算机的型号</li><li>你最喜欢的餐馆名称</li><li>驾驶执照最后四位数字</li></ul></div></div><div id="ajaxwaitid"></div>
<div id="hd">
<div class="wp">
<div class="hdc cl">
<h2><a href="http://home.lupaworld.com/" title="LUPA开源社区"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/logo.png" alt="" border="0"></a></h2>

<form method="post" autocomplete="off" id="lsform" action="http://home.lupaworld.com/member.php?mod=logging&action=login&loginsubmit=yes&infloat=yes" onsubmit="return lsSubmit()">
<div class="fastlg cl">
<span id="return_ls" style="display:none"></span>
<div class="y">
<p><a href="http://home.lupaworld.com/member.php?mod=luparegister21" onclick="showWindow(&#39;register&#39;, this.href)" class="xi2">注册</a></p>
<p><a href="http://home.lupaworld.com/member.php?mod=logging&action=login&viewlostpw" onclick="showWindow(&#39;login&#39;, this.href)" class="xi2">找回密码</a></p>
</div>
<div class="fastlg_fm y pns">
<p>
<label for="ls_username">帐号</label> <input type="text" name="username" id="ls_username" class="px vm" value="UID/用户名/Email" onfocus="if(this.value == &#39;UID/用户名/Email&#39;) this.value = &#39;&#39;;" onblur="if(this.value == &#39;&#39;) this.value = &#39;UID/用户名/Email&#39;;" tabindex="901">
&nbsp;<input type="checkbox" name="cookietime" id="ls_cookietime" class="pc" value="2592000" tabindex="903"> <label for="ls_cookietime">记住密码</label>
</p>
<p>
<label for="ls_password">密码</label> <input type="password" name="password" id="ls_password" class="px vm" autocomplete="off" tabindex="902" onfocus="lsShowmore()">
&nbsp;<button type="submit" class="pn vm"><em>登录</em></button>
</p>
<input type="hidden" name="quickforward" value="yes">
<input type="hidden" name="handlekey" value="ls">
</div>

</div>
<div id="ls_more" style="display:none">
<h3>
<em class="y"><a title="关闭" onclick="display(&#39;ls_more&#39;)" class="flbc" href="javascript:;">关闭</a></em>
安全验证
</h3>
<span class="z"><script type="text/javascript">var ls_sechash = '';</script></span>
<div class="ftid mtm mbn">
<select id="ls_questionid" width="131" name="questionid" autocomplete="off" tabindex="905" change="if($(&#39;ls_questionid&#39;).value &gt; 0) {$(&#39;ls_answer&#39;).style.display=&#39;&#39;;$(&#39;ls_answer&#39;).focus();} else {$(&#39;ls_answer&#39;).style.display=&#39;none&#39;;}" selecti="0" style="display: none; ">








<option value="0"></select><a href="javascript:;" id="ls_questionid_ctrl" style="width:131px" tabindex="905">安全提问(未设置请忽略)</a>
<input type="text" name="answer" id="ls_answer" style="display:none" autocomplete="off" size="36" class="px mtn" tabindex="906">
</div>
<script type="text/javascript">simulateSelect('ls_questionid')</script>
</div>
</form>
</div>

<div id="qmenu_menu" class="p_pop" style="display: none; zoom: 1;">
<p class="reg_tip">
<a href="http://home.lupaworld.com/member.php?mod=luparegister21" onclick="showWindow(&#39;register&#39;, this.href)" class="xi2">注册新用户，开通自己的个人中心</a>
</p>
</div>

<div id="nv">
<a href="javascript:;" id="qmenu" onmouseover="showMenu(this.id)">我的中心</a>
<ul><li id="mn_N30de" onmouseover="showMenu({&#39;ctrlid&#39;:this.id})"><a href="http://www.lupaworld.com/portal-topic-topicid-16.html" hidefocus="true">起点</a></li><li id="mn_portal" onmouseover="navShow(&#39;portal&#39;)"><a href="http://www.lupaworld.com/portal.php" hidefocus="true" title="Portal">首页<span>Portal</span></a></li><li id="mn_Nbf61" onmouseover="showMenu({&#39;ctrlid&#39;:this.id})"><a href="http://www.lupaworld.com/portal-topic-topicid-26.html" hidefocus="true">开源资讯</a></li><li id="mn_N1df1" onmouseover="showMenu({&#39;ctrlid&#39;:this.id})"><a href="http://www.lupaworld.com/proj.php" hidefocus="true">开源项目</a></li><li id="mn_N6eda" onmouseover="showMenu({&#39;ctrlid&#39;:this.id})"><a href="http://www.lupaworld.com/portal-topic-topicid-29.html" hidefocus="true">技术辅导</a></li><li id="mn_N8790" onmouseover="showMenu({&#39;ctrlid&#39;:this.id})"><a href="http://www.lupaworld.com/portal-topic-topicid-28.html" hidefocus="true">社区交流</a></li><li id="mn_N80db" onmouseover="showMenu({&#39;ctrlid&#39;:this.id})"><a href="http://www.lupaworld.com/portal-topic-topicid-30.html" hidefocus="true">资源共享</a></li><li id="mn_N5d0f" onmouseover="showMenu({&#39;ctrlid&#39;:this.id})"><a href="http://www.lupaworld.com/search-portal.html" hidefocus="true">站内搜索</a></li><li id="mn_N3e7d"><a href="http://www.lupaworld.com/portal-topic-topicid-41.html" hidefocus="true" target="_blank" style="text-decoration: underline;color: blue">参与社区</a></li></ul>
</div>
<ul class="p_pop h_pop" id="plugin_menu" style="display: none">  <li><a id="mn_plink_show" href="http://home.lupaworld.com/plugin.php?id=luckypost:show">发帖际遇</a></li>
   <li><a id="mn_plink_sign" href="http://home.lupaworld.com/plugin.php?id=dsu_paulsign:sign"></a></li>
 </ul>
<ul class="p_pop h_pop" id="mn_N30de_menu" style="display: none"><li><a href="http://www.lupaworld.com/portal-topic-topicid-17.html" hidefocus="true">什么是开源</a></li><li><a href="http://www.lupaworld.com/portal-topic-topicid-18.html" hidefocus="true">学生专区</a></li><li><a href="http://www.lupaworld.com/portal-topic-topicid-19.html" hidefocus="true">教师专区</a></li><li><a href="http://www.lupaworld.com/portal-topic-topicid-20.html" hidefocus="true">软件从业者</a></li><li><a href="http://www.lupaworld.com/portal-topic-topicid-21.html" hidefocus="true">企业和开源</a></li></ul><ul class="p_pop h_pop" id="mn_Nbf61_menu" style="display: none"><li><a href="http://www.lupaworld.com/portal-list-catid-84.html" hidefocus="true">最新消息</a></li><li><a href="http://www.lupaworld.com/portal-list-catid-90.html" hidefocus="true">特约撰稿</a></li><li><a href="http://www.lupaworld.com/portal-list-catid-102.html" hidefocus="true">软件追踪</a></li><li><a href="http://www.lupaworld.com/portal-list-catid-314.html" hidefocus="true">资讯专题</a></li><li><a href="http://www.lupaworld.com/portal-list-catid-321.html" hidefocus="true">解决方案</a></li><li><a href="http://www.lupaworld.com/portal-list-catid-85.html" hidefocus="true">社区公告</a></li><li><a href="http://www.lupaworld.com/portal-list-catid-322.html" hidefocus="true">综合资讯</a></li></ul><ul class="p_pop h_pop" id="mn_N1df1_menu" style="display: none"><li><a href="http://www.lupaworld.com/proj-class-type-tag-sid-24.html" hidefocus="true">开发工具</a></li><li><a href="http://www.lupaworld.com/proj-class-type-tag-sid-137.html" hidefocus="true">网站源码</a></li><li><a href="http://www.lupaworld.com/proj-class-type-tag-sid-42.html" hidefocus="true">插件扩展</a></li><li><a href="http://www.lupaworld.com/proj-class-type-tag-sid-8.html" hidefocus="true">企业应用</a></li></ul><ul class="p_pop h_pop" id="mn_N6eda_menu" style="display: none"><li><a href="http://code.lupaworld.com/" hidefocus="true" title="源码赏析" style="font-weight: bold;">源码赏析</a></li><li><a href="http://www.lupaworld.com/doc.php" hidefocus="true">在线文档阅读</a></li><li><a href="http://www.lupaworld.com/tv.php" hidefocus="true">开源视频</a></li><li><a href="http://www.lupaworld.com/tutorial.php" hidefocus="true">技术文章教程</a></li><li><a href="http://man.lupaworld.com/" hidefocus="true">手册下载</a></li><li><a href="http://wiki.lupaworld.com/index.php/Guide" hidefocus="true">技术学习入门</a></li><li><a href="http://www.lupaworld.com/exam.php" hidefocus="true" style="color: red">LUPA考证练习</a></li></ul><ul class="p_pop h_pop" id="mn_N8790_menu" style="display: none"><li><a href="http://www.lupaworld.com/plugin.php?id=dsu_paulsign:sign" hidefocus="true">每日签到</a></li><li><a href="http://home.lupaworld.com/home.php" hidefocus="true" title="Space">个人中心</a></li><li><a href="http://home.lupaworld.com/home-space-do-blog.html" hidefocus="true">我的日志</a></li><li><a href="http://www.lupaworld.com/home-space-do-doing.html" hidefocus="true">站内微博</a></li><li><a href="http://bbs.lupaworld.com/forum.php" hidefocus="true" title="BBS">论坛列表</a></li><li><a href="http://home.lupaworld.com/group-index.html" hidefocus="true">群组列表</a></li><li><a href="http://www.lupaworld.com/userapp.php" hidefocus="true" title="Manyou">社区娱乐</a></li></ul><ul class="p_pop h_pop" id="mn_N80db_menu" style="position: absolute; z-index: 301; left: 637px; top: 113px; display: none; "><li><a href="http://mirror.lupaworld.com/" hidefocus="true">Linux镜像</a></li><li><a href="http://linux.lupaworld.com/" hidefocus="true">Linux主题</a></li><li><a href="http://bbs.lupaworld.com/thread-161157-1-1.html" hidefocus="true">源码下载（暂停）</a></li><li><a href="http://mail.lupaworld.com/" hidefocus="true">邮件列表</a></li><li><a href="http://wiki.lupaworld.com/" hidefocus="true">开源维客知识</a></li></ul><ul class="p_pop h_pop" id="mn_N5d0f_menu" style="position: absolute; z-index: 301; left: 738px; top: 113px; display: none; "><li><a href="http://www.lupaworld.com/misc-faq.html" hidefocus="true" title="Help">社区使用帮助</a></li><li><a href="http://www.lupaworld.com/misc-ranklist.html" hidefocus="true" title="Ranklist">内容排行</a></li></ul><div id="mu" class="cl">
<ul class="cl " id="snav_mn_portal" style="display:none">
<li><a href="http://www.lupaworld.com/portal-topic-topicid-23.html" hidefocus="true" style="color: red">Linux专题</a></li><li><a href="http://www.lupaworld.com/portal-topic-topicid-53.html" hidefocus="true">学生大本营</a></li><li><a href="http://www.lupaworld.com/portal-topic-topicid-25.html" hidefocus="true">云计算</a></li><li><a href="http://www.lupaworld.com/portal-topic-topicid-36.html" hidefocus="true">开源浏览器</a></li><li><a href="http://www.lupaworld.com/portal-topic-topicid-35.html" hidefocus="true">Fedora</a></li><li><a href="http://www.lupaworld.com/portal-topic-topicid-34.html" hidefocus="true">Ubuntu</a></li><li><a href="http://www.lupaworld.com/portal-topic-topicid-37.html" hidefocus="true">开源编程</a></li><li><a href="http://www.lupaworld.com/portal-topic-topicid-38.html" hidefocus="true">Linux内核</a></li><li><a href="http://www.lupaworld.com/portal-topic-topicid-27.html" hidefocus="true">IT职业培训</a></li></ul>
</div></div>
</div>


<div id="wp" class="wp"><!-- add from jie start-->

<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/shCore.js" type="text/javascript"></script>
<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/shBrushJava.js" type="text/javascript"></script>
<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/shBrushRuby.js" type="text/javascript"></script>
<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/shBrushJScript.js" type="text/javascript"></script>
<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/shBrushPhp.js" type="text/javascript"></script>
<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/shBrushXml.js" type="text/javascript"></script>
<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/shBrushPython.js" type="text/javascript"></script>
<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/shBrushCpp.js" type="text/javascript"></script>
<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/shBrushCSharp.js" type="text/javascript"></script>
<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/shBrushCss.js" type="text/javascript"></script>
<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/shBrushSql.js" type="text/javascript"></script>

<link type="text/css" rel="stylesheet" href="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/shCoreDefault.css">
<script type="text/javascript">
//SyntaxHighlighter.defaults['gutter']=false;
SyntaxHighlighter.all();</script>

<!-- add from jie end -->


<div id="pt" class="bm cl">

<div id="sc" class="y">
<form id="scform" method="post" autocomplete="off" onsubmit="searchFocus($(&#39;srchtxt&#39;))" action="http://home.lupaworld.com/search.php?searchsubmit=yes" target="_blank">
<input type="hidden" name="formhash" value="b967f47c">
<input type="hidden" name="srchtype" value="title">
<input type="hidden" name="srhfid" value="0">
<table cellspacing="0" cellpadding="0">
<tbody><tr>
<td><a href="http://www.lupaworld.com/search.php" target="_blank" id="sctype" class="showmenu" onclick="showMenu(this.id);return false;">搜索日志</a></td>
<td><input type="text" name="srchtxt" id="srchtxt" class="px z" value="请输入搜索内容" autocomplete="off" onfocus="searchFocus(this);" onblur="searchBlur(this);"></td>
<td><button id="search_submit" name="searchsubmit" type="submit" value="true" class="xw1">搜索</button></td>
</tr>
</tbody></table>
<div id="sctype_menu" class="p_pop cl" style="display: none">
<ul><li><input type="radio" id="mod_article" class="pr" name="mod" value="portal"><label for="mod_article" title="搜索文章">文章</label></li><li><input type="radio" id="mod_thread" class="pr" name="mod" value="forum"><label for="mod_thread" title="搜索"></label></li><li><input type="radio" id="mod_blog" class="pr" name="mod" value="blog" checked="checked"><label for="mod_blog" title="搜索日志">日志</label></li><li><input type="radio" id="mod_group" class="pr" name="mod" value="group"><label for="mod_group" title="搜索"></label></li><li><input type="radio" id="mod_user" class="pr" name="mod" value="user"><label for="mod_user" title="搜索用户">用户</label></li><li><input type="radio" id="mod_project" class="pr" name="mod" value="project"><label for="mod_project" title="项目">项目</label></li><li><input type="radio" id="mod_doc" class="pr" name="mod" value="doc"><label for="mod_docr" title="文档">文档</label></li></ul>
</div>
</form>
<script type="text/javascript">initSearchmenu();</script>
</div>
<div class="z">
<a href="http://home.lupaworld.com/" class="nvhm" title="首页">LUPA开源社区</a> <em>›</em>
<a href="http://home.lupaworld.com/home.php">个人中心</a> <em>›</em> 
<a href="http://home.lupaworld.com/home-space-do-blog.html">日志</a>
<em>›</em> <a href="http://home.lupaworld.com/home-space-uid-56821-do-blog-view-me.html">ckhitler的日志</a>
</div>
</div>

<style id="diy_style" type="text/css"></style>
<div class="wp">
<!--[diy=diy1]--><div id="diy1" class="area"></div><!--[/diy]-->
</div>

<div id="ct" class="ct2_a wp cl">
<div class="mn">
<!--[diy=diycontenttop]--><div id="diycontenttop" class="area"></div><!--[/diy]-->
<div class="bm bw0">
<div class="ih pbm cl">
<div class="icn avt"><a href="http://home.lupaworld.com/space-uid-56821.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/avatar.php"></a></div>
<dl>
<dt class="ptn">ckhitler</dt>
<dd>
<a href="http://home.lupaworld.com/space-uid-56821.html">ckhitler的个人空间</a>
 <em>›</em> <a href="http://home.lupaworld.com/home-space-uid-56821-do-blog-view-me.html">TA的所有日志</a> <em>›</em> <a href="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区.htm">查看日志</a></dd>
</dl>
</div>

<div class="vw mbm">
<div class="h pbm">
<h1 class="ph">
《Linux的capability深入分析-下》</h1>
<p class="xg2">
<span class="xg1">已有 531 次阅读</span> 
<span class="xg1">2011-5-7 15:05</span>

<span class="pipe">|</span><span class="xg1">个人分类:<a href="http://home.lupaworld.com/home-space-uid-56821-do-blog-classid-957-view-me.html">LINUX系统</a></span><span class="pipe">|</span><span class="xg1">系统分类:<a href="http://home.lupaworld.com/home-space-do-blog-view-all-catid-1.html">IT技术</a></span><span class="pipe">|</span><span class="xg1">关键词:Linux capability setcap</span>
</p>
</div>

<div id="blog_article" class="d cl"><div>一)capability的工具介绍</div><div><br></div><div>在我们的试验环境是RHEL6,libcap-2.16软件包中包含了相关的capability设置及查看工作,如下:</div><div><br></div><div>rpm -ql libcap-2.16-5.2.el6.i686&nbsp;</div><div>/lib/libcap.so.2</div><div>/lib/libcap.so.2.16</div><div>/lib/security/pam_cap.so</div><div>/usr/sbin/capsh</div><div>/usr/sbin/getcap</div><div>/usr/sbin/getpcaps</div><div>/usr/sbin/setcap</div><div>/usr/share/doc/libcap-2.16</div><div>/usr/share/doc/libcap-2.16/License</div><div>/usr/share/doc/libcap-2.16/capability.notes</div><div>/usr/share/man/man8/getcap.8.gz</div><div>/usr/share/man/man8/setcap.8.gz</div><div><br></div><div>getcap可以获得程序文件所具有的能力(CAP).</div><div>getpcaps可以获得进程所具有的能力(CAP).</div><div>setcap可以设置程序文件的能力(CAP).</div><div>我们下面主要用setcap来进行调试.</div><div><br></div><div><br></div><div>二)CAP_CHOWN 0(允许改变文件的所有权)</div><div><br></div><div>授权普通用户可以用/bin/chown程序更改任意文件的owner,如下:</div><div>setcap cap_chown=eip /bin/chown&nbsp;</div><div><br></div><div>查看/bin/chown程序的能力值,如下:</div><div>getcap /bin/chown &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>/bin/chown = cap_chown+eip</div><div><br></div><div>切换到test用户,将/bin/ls程序的owner改为test,如下:</div><div>su - test</div><div>chown test.test /bin/ls</div><div><br></div><div>ls -l /bin/ls</div><div>-rwxr-xr-x. 1 test test 118736 Jun 14 &nbsp;2010 /bin/ls</div><div><br></div><div>注:</div><div>1)cap_chown=eip是将chown的能力以cap_effective(e),cap_inheritable(i),cap_permitted(p)三种位图的方式授权给相关的程序文件.</div><div>2)如果改变文件名,则能力保留到新文件.</div><div>3)用setcap -r /bin/chown可以删除掉文件的能力.</div><div>4)重新用setcap授权将覆盖之前的能力.&nbsp;</div><div><br></div><div><br></div><div>三)CAP_DAC_OVERRIDE 1(忽略对文件的所有DAC访问限制)</div><div><br></div><div>授权普通用户可以用/usr/bin/vim程序修改所有文件的内容,如下:</div><div>setcap cap_dac_override=eip /usr/bin/vim&nbsp;</div><div><br></div><div>切换到普通用户</div><div>su - test</div><div><br></div><div>修改/etc/shadow文件内容</div><div>vim /etc/shadow</div><div>root:$6$3hJf.BoIVU/cdLKb$JxLXcQScrLS032aFPAQvVc4RzKYNadcIIzxmzAIw.jejrYOHhqdr0oV7sNBL.IhGBo.mMOYEdevlnCp2OGku8.:15094:0:99999:7:::</div><div>bin:*:14790:0:99999:7:::</div><div>daemon:*:14790:0:99999:7:::</div><div>adm:*:14790:0:99999:7:::</div><div><br></div><div>注:</div><div>DAC_OVERRIDE能力是DAC_READ_SEARCH能力的超集.</div><div><br></div><div><br></div><div><br></div><div>四)CAP_DAC_READ_SEARCH 2(忽略所有对读、搜索操作的限制)</div><div><br></div><div>授权普通用户可以用/bin/cat程序查看所有文件的内容,如下:</div><div>setcap cap_dac_read_search=eip /bin/cat</div><div><br></div><div>切换到普通用户</div><div>su - test</div><div><br></div><div>查看/etc/shadow,如下:</div><div>cat /etc/shadow</div><div>root:$6$3hJf.BoIVU/cdLKb$JxLXcQScrLS032aFPAQvVc4RzKYNadcIIzxmzAIw.jejrYOHhqdr0oV7sNBL.IhGBo.mMOYEdevlnCp2OGku8.:15094:0:99999:7:::</div><div>bin:*:14790:0:99999:7:::</div><div>daemon:*:14790:0:99999:7:::</div><div>adm:*:14790:0:99999:7:::</div><div><br></div><div><br></div><div><br></div><div>五)CAP_FOWNER 3(以最后操作的UID,覆盖文件的先前的UID)</div><div><br></div><div><br></div><div>cp /etc/passwd /tmp/</div><div>ls -l /tmp/passwd &nbsp;&nbsp;</div><div>-rw-r--r-- 1 root root 1171 2011-04-29 19:21 /tmp/passwd</div><div><br></div><div>授权cap_fowner权限给/usr/bin/vim</div><div>setcap cap_fowner=eip /usr/bin/vim</div><div><br></div><div>切换到test用户</div><div>su - test</div><div><br></div><div>编辑/tmp/passwd文件,存盘退出.</div><div>vi /tmp/passwd</div><div>修改文件,并保存退出.</div><div><br></div><div><br></div><div>查看/tmp/passwd,发现owner已经变成test</div><div>-rw-r--r-- 1 test test 1176 2011-04-29 19:21 /tmp/passwd</div><div><br></div><div><br></div><div><br></div><div>六)CAP_FSETID 4(确保在文件被修改后不修改setuid/setgid位)</div><div>起因是当文件被修改后,会清除掉文件的setuid/setgid位,而设定CAP_FSETID后将保证setuid/setgid位不被清除.但这对chown函数无用.</div><div><br></div><div>测试程序如下:</div><div>#include &lt;sys/types.h&gt;</div><div>#include &lt;sys/types.h&gt;</div><div>#include &lt;sys/stat.h&gt;</div><div>#include &lt;fcntl.h&gt;</div><div>#include &lt;sys/stat.h&gt;</div><div>#include &lt;stdio.h&gt;</div><div>#include &lt;stdlib.h&gt;</div><div>#include &lt;string.h&gt;</div><div>main()</div><div>{</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;int handle;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;char string[40];</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;int length, res;</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if ((handle = open("/tmp/passwd", O_WRONLY | O_CREAT | O_TRUNC,S_IREAD | S_IWRITE)) == -1)</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;printf("Error opening file.\n");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit(1);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;strcpy(string, "Hello, world!\n");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;length = strlen(string);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if ((res = write(handle, string, length)) != length)</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;printf("Error writing to the file.\n");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit(1);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;printf("Wrote %d bytes to the file.\n", res);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;close(handle);</div><div>}</div><div>gcc fsetid.c -o fsetid</div><div><br></div><div>先测试没有设FSETID的情况,如下:</div><div>chmod 6777 /tmp/passwd</div><div>ls -l /tmp/passwd</div><div>-rwsrwsrwx 1 test test 14 2011-04-30 14:22 /tmp/passwd</div><div>/tmp/fsetid&nbsp;</div><div>Wrote 14 bytes to the file.</div><div>ls -l /tmp/passwd</div><div>-rwxrwxrwx 1 test test 14 2011-04-30 14:25 /tmp/passwd</div><div>我们看到setuid/setgid位被清除了.</div><div><br></div><div>下面是设定FSETID,如下:</div><div>chmod 6777 /tmp/passwd</div><div>ls -l /tmp/passwd &nbsp; &nbsp;&nbsp;</div><div>-rwsrwsrwx 1 test test 14 2011-04-30 14:25 /tmp/passwd</div><div><br></div><div>切换到root用户,给/tmp/fsetid程序授权CAP_FSETID能力,如下:</div><div>setcap cap_fsetid=eip /tmp/fsetid</div><div><br></div><div>切换到普通用户</div><div>/tmp/fsetid</div><div>Wrote 14 bytes to the file.</div><div>ls -l /tmp/passwd</div><div>-rwsrwsrwx 1 test test 14 2011-04-30 14:28 /tmp/passwd</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div>七)CAP_KILL 5 (允许对不属于自己的进程发送信号)</div><div><br></div><div><br></div><div>我们先模拟没有加CAP_KILL能力的情况,如下:</div><div><br></div><div>终端1,用root用户启用top程序,如下:</div><div>su - root</div><div>top</div><div><br></div><div>终端2,用test用户kill之前的top进程,如下:</div><div>pgrep top &nbsp; &nbsp;&nbsp;</div><div>3114</div><div>/bin/kill 3114</div><div>kill: Operation not permitted</div><div>我们发现无法对不属于自己的进程发送信号.</div><div><br></div><div><br></div><div>下面我们用CAP_KILL能力的程序向不属于自己的进程发送信号,如下:</div><div><br></div><div>设定kill命令的kill位,如下:</div><div>setcap cap_kill=eip /bin/kill&nbsp;</div><div><br></div><div>杀掉3114进程,没有问题,如下:</div><div>/bin/kill 3114</div><div>echo $?</div><div>0</div><div><br></div><div>注意:</div><div>普通用户要用/bin/kill这种绝对路径的方式,而不能用kill这种方式.</div><div><br></div><div><br></div><div><br></div><div>八)CAP_SETGID 6 (设定程序允许普通用户使用setgid函数,这与文件的setgid权限位无关)</div><div><br></div><div><br></div><div>cp /etc/shadow /tmp/</div><div>chown root.root /tmp/shadow</div><div>chmod 640 /tmp/shadow</div><div><br></div><div>切换到普通用户test,并编写setgid测试程序,如下:</div><div>su - test</div><div>#include &lt;unistd.h&gt;</div><div>int</div><div>main ()</div><div>{</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;gid_t gid = 0;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;setgid(gid);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;system("/bin/cat /tmp/shadow");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;return 0;</div><div>}</div><div>gcc setgid.c -o setgid</div><div><br></div><div>更改setgid程序为CAP_SETGID</div><div>setcap cap_setgid=eip /tmp/setgid</div><div><br></div><div>切换到普通用户,运行/tmp/setgid程序,如下:</div><div>su - test</div><div>/tmp/setgid&nbsp;</div><div>root:$1$S9AmPHY8$ZIdORp6aLnYleb5EORxw8/:14479:0:99999:7:::</div><div>daemon:*:14479:0:99999:7:::</div><div>bin:*:14479:0:99999:7:::</div><div>sys:*:14479:0:99999:7:::</div><div>sync:*:14479:0:99999:7:::</div><div>games:*:14479:0:99999:7:::</div><div>man:*:14479:0:99999:7:::</div><div>lp:*:14479:0:99999:7:::</div><div>mail:*:14479:0:99999:7:::</div><div>news:*:14479:0:99999:7:::</div><div>uucp:*:14479:0:99999:7:::</div><div>proxy:*:14479:0:99999:7:::</div><div>www-data:*:14479:0:99999:7:::</div><div>backup:*:14479:0:99999:7:::</div><div>list:*:14479:0:99999:7:::</div><div><br></div><div>我们看到普通用户可以查看/tmp/shadow文件,而取消CAP_SETGID则使程序不能拥有setgid的权限,如下:</div><div>setcap -r /tmp/setgid</div><div><br></div><div>su - test</div><div>/tmp/setgid&nbsp;</div><div>/bin/cat: /tmp/shadow: Permission denied</div><div><br></div><div><br></div><div><br></div><div><br></div><div>九)CAP_SETUID 7 (设定程序允许普通用户使用setuid函数,这也文件的setuid权限位无关)</div><div><br></div><div><br></div><div>cp /etc/shadow /tmp/</div><div>chown root.root /tmp/shadow</div><div>chmod 640 /tmp/shadow</div><div><br></div><div>切换到普通用户test,并编写setuid测试程序,如下:</div><div>su - test</div><div>cd /tmp/</div><div>vi setuid.c</div><div>#include &lt;unistd.h&gt;</div><div>int</div><div>main ()</div><div>{</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;uid_t uid = 0;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;setuid(uid);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;system("/bin/cat /tmp/shadow");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;return 0;</div><div>}</div><div>gcc setuid.c -o setuid</div><div><br></div><div>切换到root用户,更改setuid程序为CAP_SETUID</div><div>su - root</div><div>setcap cap_setuid=eip /tmp/setuid</div><div><br></div><div>切换到test用户,运行/tmp/setuid程序,如下:</div><div>su - test</div><div>/tmp/setuid</div><div>root:$1$S9AmPHY8$ZIdORp6aLnYleb5EORxw8/:14479:0:99999:7:::</div><div>daemon:*:14479:0:99999:7:::</div><div>bin:*:14479:0:99999:7:::</div><div>sys:*:14479:0:99999:7:::</div><div>sync:*:14479:0:99999:7:::</div><div>games:*:14479:0:99999:7:::</div><div>man:*:14479:0:99999:7:::</div><div>lp:*:14479:0:99999:7:::</div><div><br></div><div>我们看到普通用户可以查看/tmp/shadow文件,而取消CAP_SETUID则使程序不能拥有setuid的权限,如下:</div><div><br></div><div>setcap -r /tmp/setuid</div><div><br></div><div>su - test</div><div>/tmp/setuid&nbsp;</div><div>/bin/cat: /tmp/shadow: Permission denied</div><div><br></div><div><br></div><div><br></div><div><br></div><div>十)CAP_SETPCAP 8 (允许向其它进程转移能力以及删除其它进程的任意能力)</div><div>事实上只有init进程可以设定其它进程的能力,而其它程序无权对进程授权,root用户也不能对其它进程的能力进行修改,只能对当前进程通过cap_set_proc等函数进行修改,而子进程也会继承这种能力.</div><div>所以即使使用了CAP_SETPCAP能力,也不会起到真正的作用.</div><div><br></div><div><br></div><div><br></div><div><br></div><div>十一)CAP_LINUX_IMMUTABLE 9 (允许修改文件的不可修改(IMMUTABLE)和只添加(APPEND-ONLY)属性)</div><div>普通用户不能通过chattr对文件设置IMMUTABLE(chattr +i)和APPEND-ONLY(chattr +a)权限,而通过CAP_LINUX_IMMUTABLE可以使普通用户通过自己增减(immutable/append-only)权限.</div><div><br></div><div><br></div><div><br></div><div>普通用户通过chattr给文件增加immutable权限,如下:</div><div>touch /tmp/test</div><div>chattr +i /tmp/test</div><div>chattr: Operation not permitted while setting flags on /tmp/test</div><div><br></div><div>我们看到授权失败了,而如果我们对chattr增加了LINUX_IMMUTABLE权限,则可以成功,如下:</div><div>此时切换到root用户:</div><div>su -&nbsp;</div><div>setcap cap_linux_immutable=eip /usr/bin/chattr&nbsp;</div><div><br></div><div>切换到普通用户:</div><div>su - test</div><div>chattr +i /tmp/test</div><div>lsattr /tmp/test&nbsp;</div><div>----i-------------- /tmp/test</div><div>我们看到授权成功了,注意,这里只能对自己的文件授权(immutable/append-only)权限,对于其它用户的权限LINUX_IMMUTABLE不起作用(root除外),如下:</div><div>su - test</div><div>chattr +i /etc/passwd</div><div>chattr: Permission denied while setting flags on /etc/passwd</div><div><br></div><div><br></div><div><br></div><div><br></div><div>十二)CAP_NET_BIND_SERVICE 10(允许绑定到小于1024的端口)</div><div>普通用户不能通过bind函数绑定小于1024的端口,而root用户可以做到,CAP_NET_BIND_SERVICE的作用就是让普通用户也可以绑端口到1024以下.</div><div><br></div><div>普通用户通过nc绑定端口500,如下:</div><div>nc -l -p 500</div><div>Can't grab 0.0.0.0:500 with bind : Permission denied</div><div><br></div><div>增加CAP_NET_BIND_SERVICE能力到nc程序,如下:</div><div>setcap cap_net_bind_service=eip /usr/bin/nc</div><div><br></div><div>再切换到普通用户,通过nc绑定端口500,如下:</div><div>nc -l -p 500</div><div><br></div><div>查看该端口:</div><div>netstat -tulnp|grep nc</div><div>tcp &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 0.0.0.0:500 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0:* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LISTEN &nbsp; &nbsp; &nbsp;2523/nc &nbsp; &nbsp; &nbsp;&nbsp;</div><div><br></div><div><br></div><div><br></div><div><br></div><div>十三)CAP_NET_BROADCAST 11(允许网络广播和多播访问)</div><div><br></div><div>事实上它并没有被应用,普通用户也可以使用ping -b 192.168.0.255也发送广播包</div><div><br></div><div><br></div><div><br></div><div><br></div><div>十四)CAP_NET_ADMIN 12(允许执行网络管理任务:接口,防火墙和路由等)</div><div><br></div><div>普通用户不能创建新的网络接口(interface),不能更改ip地址,而CAP_NET_ADMIN可以帮助普通用户完成这项工作,如下:</div><div><br></div><div>用普通用户创建新的网卡接口eth0:1失败</div><div>/sbin/ifconfig eth0:1 172.16.27.133 netmask 255.255.255.0</div><div>SIOCSIFADDR: Permission denied</div><div>SIOCSIFFLAGS: Permission denied</div><div>SIOCSIFNETMASK: Permission denied</div><div><br></div><div>此时我们把CAP_NET_ADMIN能力授权给ifconfig程序,如下:</div><div>setcap cap_net_admin=eip /sbin/ifconfig</div><div><br></div><div>我们再次用普通用户即可以新建网络接口eth0:1,并可以DOWN掉接口,如下:</div><div>/sbin/ifconfig eth0:1 172.16.27.133 netmask 255.255.255.0</div><div>/sbin/ifconfig eth0:1</div><div>eth0:1 &nbsp; &nbsp;Link encap:Ethernet &nbsp;HWaddr 00:0c:29:f9:5e:06 &nbsp;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;inet addr:172.16.27.133 &nbsp;Bcast:172.16.27.255 &nbsp;Mask:255.255.255.0</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UP BROADCAST RUNNING MULTICAST &nbsp;MTU:1500 &nbsp;Metric:1</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Interrupt:18 Base address:0x1080&nbsp;</div><div><br></div><div>/sbin/ifconfig eth0:1 down&nbsp;</div><div><br></div><div>同样CAP_NET_ADMIN可以让普通用户增加/删除路由,如下:</div><div>/sbin/route add -host 192.168.27.139 gw 192.168.27.2</div><div>SIOCADDRT: Operation not permitted</div><div><br></div><div>授权NET_ADMIN,如下:</div><div>setcap cap_net_admin=eip /sbin/route</div><div><br></div><div>再次用普通用户增加路由,如下:</div><div>/sbin/route add -host 192.168.27.139 gw 192.168.27.2</div><div>/sbin/route &nbsp;-n</div><div>Kernel IP routing table</div><div>Destination &nbsp; &nbsp; Gateway &nbsp; &nbsp; &nbsp; &nbsp; Genmask &nbsp; &nbsp; &nbsp; &nbsp; Flags Metric Ref &nbsp; &nbsp;Use Iface</div><div>192.168.27.139 &nbsp;192.168.27.2 &nbsp; &nbsp;255.255.255.255 UGH &nbsp; 0 &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp;0 eth0</div><div>192.168.27.0 &nbsp; &nbsp;0.0.0.0 &nbsp; &nbsp; &nbsp; &nbsp; 255.255.255.0 &nbsp; U &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp;0 eth0</div><div>0.0.0.0 &nbsp; &nbsp; &nbsp; &nbsp; 192.168.27.2 &nbsp; &nbsp;0.0.0.0 &nbsp; &nbsp; &nbsp; &nbsp; UG &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp;0 eth0</div><div>/sbin/route del -host 192.168.27.139 gw 192.168.27.2 &nbsp;&nbsp;</div><div><br></div><div>我们看到我们除了可以增加路由之外,也可以删除路由.</div><div><br></div><div>最后NET_ADMIN可以帮助我们让普通用户来管理防火墙.</div><div>普通用户不能用iptables来管理防火墙,如下:</div><div>/sbin/iptables -L -n</div><div>iptables v1.4.2: can't initialize iptables table `filter': Permission denied (you must be root)</div><div>Perhaps iptables or your kernel needs to be upgraded.</div><div><br></div><div>我们将CAP_NET_ADMIN授权给iptables程序,注意我们也要将CAP_NET_RAW授权给iptables,CAP_NET_RAW我们后面再解释,如下:</div><div>setcap cap_net_admin,cap_net_raw=eip /sbin/iptables-multi</div><div><br></div><div>此时就可以用普通用户来管理防火墙了,如下:</div><div>/sbin/iptables -A INPUT -p tcp -j ACCEPT</div><div>/sbin/iptables -L -n</div><div>Chain INPUT (policy ACCEPT)</div><div>target &nbsp; &nbsp; prot opt source &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; destination &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>ACCEPT &nbsp; &nbsp; tcp &nbsp;-- &nbsp;0.0.0.0/0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div><br></div><div>Chain FORWARD (policy ACCEPT)</div><div>target &nbsp; &nbsp; prot opt source &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; destination &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div><br></div><div>Chain OUTPUT (policy ACCEPT)</div><div>target &nbsp; &nbsp; prot opt source &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; destination &nbsp; &nbsp;&nbsp;</div><div><br></div><div>我们也可以删除防火墙策略,并清空当前的数据流量,如下:</div><div>/sbin/iptables -F</div><div>/sbin/iptables -Z</div><div>/sbin/iptables -X</div><div><br></div><div><br></div><div><br></div><div><br></div><div>十五)CAP_NET_RAW 13 (允许使用原始(raw)套接字)</div><div>原始套接字编程可以接收到本机网卡上的数据帧或者数据包,对监控网络流量和分析是很有作用的.</div><div><br></div><div>最常见的就是ping的实现,如下:</div><div>socket(PF_INET, SOCK_RAW, IPPROTO_ICMP) = 3</div><div><br></div><div><br></div><div>我们先把ping的setuid权限去掉</div><div>chmod u-s /bin/ping</div><div>ls -l /bin/ping</div><div>-rwxr-xr-x 1 root root 30788 2007-12-09 23:03 /bin/ping</div><div><br></div><div>用普通用户使用ping</div><div>ping &nbsp;192.168.27.2 &nbsp;</div><div>ping: icmp open socket: Operation not permitted</div><div><br></div><div>提示没有权限,我们将ping授权CAP_NET_RAW能力,如下:</div><div>setcap cap_net_raw=eip /bin/ping</div><div><br></div><div>切换到普通用户再次ping 192.168.27.2,发现可以ping通,如下:</div><div>ping &nbsp;192.168.27.2</div><div>PING 192.168.27.2 (192.168.27.2) 56(84) bytes of data.</div><div>64 bytes from 192.168.27.2: icmp_seq=1 ttl=128 time=0.266 ms</div><div>64 bytes from 192.168.27.2: icmp_seq=2 ttl=128 time=0.280 ms</div><div>64 bytes from 192.168.27.2: icmp_seq=3 ttl=128 time=0.319 ms</div><div><br></div><div>NET_RAW也同样用于tcpdump/iftop,一个普通用户无法使用tcpdump/iftop,而CAP_NET_RAW可以解决这个问题,方式同ping一样,所以我们不做演示.</div><div><br></div><div><br></div><div><br></div><div><br></div><div>十六)CAP_IPC_LOCK 14 (在允许锁定内存片段)</div><div>root和普通用户都可以用mlock来锁定内存,区别是root不受ulimit下的锁定内存大小限制,而普通用户会受到影响.</div><div><br></div><div>测试程序如下:</div><div>#include &lt;stdio.h&gt;</div><div>#include &lt;sys/mman.h&gt;</div><div><br></div><div>int main(int argc, char* argv[])</div><div>{</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;int array[2048];</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (mlock((const void *)array, sizeof(array)) == -1) {</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;perror("mlock: ");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return -1;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;printf("success to lock stack mem at: %p, len=%zd\n",</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;array, sizeof(array));</div><div><br></div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (munlock((const void *)array, sizeof(array)) == -1) {</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;perror("munlock: ");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return -1;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;printf("success to unlock stack mem at: %p, len=%zd\n",</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;array, sizeof(array));</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;return 0;</div><div>}</div><div>gcc mlock.c -o mlock</div><div><br></div><div>切换到普通用户,我们看到mlock是不受限制</div><div>ulimit -a</div><div>max locked memory &nbsp; &nbsp; &nbsp; (kbytes, -l) unlimited</div><div><br></div><div>我们运行程序</div><div>./mlock</div><div>success to lock stack mem at: 0xbfd94914, len=8192</div><div>success to unlock stack mem at: 0xbfd94914, len=8192</div><div><br></div><div><br></div><div>我们将限制改为1KB,再次运行程序,如下:</div><div>ulimit -l 1</div><div>./mlock</div><div>mlock: : Cannot allocate memory</div><div><br></div><div>切换到root用户,将CAP_IPC_LOCK能力授权给mlock测试程序,如下:</div><div>setcap cap_ipc_lock=eip /tmp/mlock</div><div><br></div><div>用普通用户再次运行程序,执行成功:</div><div>./mlock</div><div>success to lock stack mem at: 0xbfec1584, len=8192</div><div>success to unlock stack mem at: 0xbfec1584, len=8192</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div>十七)CAP_IPC_OWNER 15 (忽略IPC所有权检查)</div><div>这个能力对普通用户有作用,如果用root用户创建共享内存(shmget),权限为600,而普通用户不能读取该段共享内存.</div><div>通过CAP_IPC_OWNER可以让普通用户的程序可以读取/更改共享内存.</div><div><br></div><div>我们用下面的程序创建共享内存段,并写入0xdeadbeef到共享内存段中.</div><div>#include &lt;stdio.h&gt;</div><div>#include &lt;string.h&gt;</div><div>#include &lt;stdlib.h&gt;</div><div>#include &lt;unistd.h&gt;</div><div>#include &lt;sys/ipc.h&gt;</div><div>#include &lt;sys/shm.h&gt;</div><div>#include &lt;sys/wait.h&gt;</div><div><br></div><div>void error_out(const char *msg)</div><div>{</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;perror(msg);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;exit(EXIT_FAILURE);</div><div>}</div><div><br></div><div><br></div><div>int main (int argc, char *argv[])</div><div>{</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;key_t mykey = 12345678;</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;const size_t region_size = sysconf(_SC_PAGE_SIZE);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;int smid = shmget(mykey, region_size, IPC_CREAT|0600);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if(smid == -1)</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;error_out("shmget");</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;void *ptr;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;ptr = shmat(smid, NULL, 0);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (ptr == (void *) -1)</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;error_out("shmat");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;u_long *d = (u_long *)ptr;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;*d = 0xdeadbeef;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;printf("ipc mem %#lx\n", *(u_long *)ptr);</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;return 0;</div><div>}</div><div><br></div><div>gcc test.c -o test -lrt</div><div>我们用root用户来执行本程序,创建共享内存,如下:</div><div>/tmp/test</div><div>ipc mem 0xdeadbeef</div><div><br></div><div>查看当前的共享内存</div><div>ipcs -m</div><div><br></div><div>------ Shared Memory Segments --------</div><div>key &nbsp; &nbsp; &nbsp; &nbsp;shmid &nbsp; &nbsp; &nbsp;owner &nbsp; &nbsp; &nbsp;perms &nbsp; &nbsp; &nbsp;bytes &nbsp; &nbsp; &nbsp;nattch &nbsp; &nbsp; status &nbsp; &nbsp; &nbsp;</div><div>0x00bc614e 458752 &nbsp; &nbsp; root &nbsp; &nbsp; &nbsp;600 &nbsp; &nbsp; &nbsp; &nbsp;4096 &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div><div><br></div><div>修改程序,将*d = 0xdeadbeef;改为*d = 0xffffffff;</div><div>再编译,用普通用户运行程序,如下:</div><div>gcc test.c -o test -lrt</div><div><br></div><div>su - test</div><div>/tmp/test</div><div>shmget: Permission denied</div><div>我们看到没有权限更改共享内存.</div><div><br></div><div>用root用户把CAP_IPC_OWNER能力授权给test程序,如下:</div><div>setcap cap_ipc_owner=eip /tmp/test</div><div><br></div><div>再次用普通用户运行程序test,更改共享内存,如下:</div><div>/tmp/test</div><div>ipc mem 0xffffffff</div><div><br></div><div>我们看到修改成功,但要说明CAP_IPC_OWNER不能让进程/程序删除/脱离共享内存</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div>十八)CAP_SYS_MODULE 16 (允许普通用户插入和删除内核模块)</div><div>由于普通用户不能插入/删除内核模块,而CAP_SYS_MODULE可以帮助普通用户做到这点</div><div><br></div><div>例如,用户test插入内核模块nvram</div><div><br></div><div>/sbin/modprobe nvram &nbsp; &nbsp; &nbsp;</div><div>FATAL: Error inserting nvram (/lib/modules/2.6.38.4/kernel/drivers/char/nvram.ko): Operation not permitted</div><div><br></div><div>系统提示权限不足.</div><div><br></div><div>我们把CAP_SYS_MODULE能力授权给modprobe程序,如下:</div><div>setcap cap_sys_module=eip /sbin/modprobe</div><div><br></div><div><br></div><div>再用普通用户加载内核模块,如下:</div><div>/sbin/modprobe nvram</div><div>lsmod |grep nvram</div><div>nvram &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3861 &nbsp;0&nbsp;</div><div>我们看到可以加载.</div><div><br></div><div>同样我们可以将CAP_SYS_MODULE授权给rmmod程序,让其可以删除模块,如下:</div><div>setcap cap_sys_module=eip /sbin/rmmod</div><div><br></div><div>su - test</div><div>/sbin/rmmod nvram</div><div>lsmod |grep nvram</div><div><br></div><div><br></div><div><br></div><div><br></div><div>十九)CAP_SYS_RAWIO 17 (允许用户打开端口,并读取修改端口数据,一般用ioperm/iopl函数)</div><div><br></div><div>ioperm只有低端的[0-0x3ff] I/O端口可被设置,且普通用户不能使用.</div><div>iopl可以用于所有的65536个端口,因此ioperm相当于iopl调用的一个子集.</div><div><br></div><div>下面的程序首先设置0x3FF端口的读写权限,然后读出原先的值,然后将原值的LSB翻转并写回端口,并在此读取端口值.</div><div>#include &lt;unistd.h&gt;</div><div>#include &lt;sys/io.h&gt;</div><div><br></div><div>#define PORT_ADDR 0x3FF</div><div><br></div><div>int main(void)</div><div>{</div><div>&nbsp;&nbsp; &nbsp; &nbsp;int ret;</div><div>&nbsp;&nbsp; &nbsp; &nbsp;char port_val;</div><div>&nbsp;&nbsp; &nbsp; &nbsp;</div><div>&nbsp;&nbsp; &nbsp; &nbsp;/*set r/w permission of all 65536 ports*/</div><div>&nbsp;&nbsp; &nbsp; &nbsp;ret = iopl(3);</div><div>&nbsp;&nbsp; &nbsp; &nbsp;if(ret &lt; 0){</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; perror("iopl set error");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 0;</div><div>&nbsp;&nbsp; &nbsp; &nbsp;}</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp;port_val = inb(PORT_ADDR);</div><div>&nbsp;&nbsp; &nbsp; &nbsp;printf("Original value of port 0x%x is : %.2x\n", PORT_ADDR, port_val);</div><div>&nbsp;&nbsp; &nbsp; &nbsp;</div><div>&nbsp;&nbsp; &nbsp; &nbsp;/*reverse the least significant bit */</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp;outb(port_val^0x01, PORT_ADDR);</div><div>&nbsp;&nbsp; &nbsp; &nbsp;port_val = inb(PORT_ADDR);</div><div>&nbsp;&nbsp; &nbsp; &nbsp;printf("Current value of port 0x%x is : %.2x\n", PORT_ADDR, port_val);</div><div>&nbsp;&nbsp; &nbsp; &nbsp;</div><div>&nbsp;&nbsp; &nbsp; &nbsp;/*set r/w permission of &nbsp;all 65536 ports*/</div><div>&nbsp;&nbsp; &nbsp; &nbsp;</div><div>&nbsp;&nbsp; &nbsp; &nbsp;ret = iopl(0);</div><div>&nbsp;&nbsp; &nbsp; &nbsp;if(ret &lt; 0){</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; perror("iopl set error");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 0;</div><div>&nbsp;&nbsp; &nbsp; &nbsp;}</div><div>&nbsp;&nbsp; &nbsp; &nbsp;return 0;</div><div>}</div><div><br></div><div>编译:</div><div>gcc iopl.c -o iopl</div><div><br></div><div>普通用户运行iopl程序,提示没有权限.</div><div>/tmp/iopl&nbsp;</div><div>iopl set error: Operation not permitted</div><div><br></div><div>给程序iopl授权CAP_SYS_RAWIO能力,此时普通用户可以执行iopl程序,如下:</div><div>setcap cap_sys_rawio=eip /tmp/iopl</div><div><br></div><div>su - test</div><div>/tmp/iopl&nbsp;</div><div>Original value of port 0x3ff is : 01</div><div>Current value of port 0x3ff is : 00</div><div>/tmp/iopl&nbsp;</div><div>Original value of port 0x3ff is : 00</div><div>Current value of port 0x3ff is : 01</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div>二十)CAP_SYS_CHROOT 18 (允许使用chroot()系统调用)</div><div><br></div><div>普通用户不能通过chroot系统调用更改程式执行时所参考的根目录位置,而CAP_SYS_CHROOT可以帮助普通用户做到这一点.</div><div><br></div><div>普通用户使用chroot,如下:</div><div>/usr/sbin/chroot / /bin/bash</div><div>/usr/sbin/chroot: cannot change root directory to /: Operation not permitted</div><div><br></div><div>通过root授权CAP_SYS_CHROOT能力给chroot程序,如下:</div><div>capset cap_sys_chroot=eip /usr/sbin/chroot</div><div><br></div><div><br></div><div>普通用户再次用chroot切换根目录,如下:</div><div>/usr/sbin/chroot / /bin/sh</div><div>sh-3.2$</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div>二十一)CAP_SYS_PTRACE 19 (允许跟踪任何进程)</div><div><br></div><div>普通用户不能跟踪任何进程,不包括它自己的进程,而CAP_SYS_PTRACE可以帮助普通用户跟踪任何进程.</div><div><br></div><div>切换到普通用户,跟踪PID1的进程.</div><div>strace -p 1</div><div>attach: ptrace(PTRACE_ATTACH, ...): Operation not permitted</div><div><br></div><div>切换到root用户,将CAP_SYS_PTRACE能力授权给strace程序,用于跟踪进程,如下:</div><div>setcap cap_sys_ptrace=eip /usr/bin/strace</div><div><br></div><div>切换到普通用户,跟踪PID1的进程,如下:</div><div>strace -p 1</div><div>Process 1 attached - interrupt to quit</div><div>select(11, [10], NULL, NULL, {3, 771381}) = 0 (Timeout)</div><div>time(NULL) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 1304348451</div><div>stat64("/dev/initctl", {st_mode=S_IFIFO|0600, st_size=0, ...}) = 0</div><div>fstat64(10, {st_mode=S_IFIFO|0600, st_size=0, ...}) = 0</div><div>stat64("/dev/initctl", {st_mode=S_IFIFO|0600, st_size=0, ...}) = 0</div><div>select(11, [10], NULL, NULL, {5, 0}) &nbsp; &nbsp;= 0 (Timeout)</div><div>time(NULL) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 1304348456</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div>二十二)CAP_SYS_PACCT 20 (允许配置进程记帐process accounting)&nbsp;</div><div><br></div><div>要完成进程记帐,要保证有写入文件的权限,这里我们将进程记录写入到/home/test/log/psacct.</div><div>mkdir /home/test/log/</div><div>touch /home/test/log/psacct</div><div><br></div><div><br></div><div>程序通过acct函数,将进程的记帐写入到指定文件中,如果acct函数的参数为NULL,则关闭进程记帐.</div><div>#include &lt;stdlib.h&gt;</div><div>#include &lt;sys/acct.h&gt;</div><div><br></div><div>int</div><div>main()</div><div>{</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;int ret;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;ret = acct("/home/test/log/pacct");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if(ret &lt; 0){</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; perror("acct on error");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 0;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;system("/bin/ls -l");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;acct(NULL);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if(ret &lt; 0){</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; perror("acct off error");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 0;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;return 0;</div><div>}</div><div>gcc psacct.c -o psacct</div><div><br></div><div>./psacct&nbsp;</div><div>acct on error: Operation not permitted</div><div><br></div><div>给psacct程序授权CAP_SYS_PACCT能力,如下:</div><div>setcap cap_sys_psacct /home/test/psacct</div><div>注意这里的能力是sys_psacct,而不是sys_pacct</div><div><br></div><div><br></div><div>回到普通用户,执行psacct</div><div>./psacct&nbsp;</div><div>total 24</div><div>drwxr-xr-x 2 test test 4096 2011-05-02 13:28 log</div><div>-rw-r--r-- 1 test test &nbsp; 64 2011-05-02 13:25 pacct</div><div>-rwxr-xr-x 1 test test 6590 2011-05-02 13:31 psacct</div><div>-rw-r--r-- 1 test test &nbsp;314 2011-05-02 13:31 psacct.c</div><div><br></div><div>我们看到已经执行成功,下面我们再看下进程记录,如下:</div><div>lastcomm -f /home/test/log/pacct&nbsp;</div><div>ls &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; test &nbsp; &nbsp; pts/0 &nbsp; &nbsp; &nbsp;0.03 secs Mon May &nbsp;2 13:33</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div>二十三)CAP_SYS_ADMIN 21 (允许执行系统管理任务,如挂载/卸载文件系统,设置磁盘配额,开/关交换设备和文件等)</div><div><br></div><div>下面是普通用户拥有相关管理权限的测试</div><div><br></div><div><br></div><div>1)更改主机名</div><div>setcap cap_sys_admin=eip /bin/hostname</div><div><br></div><div>su - test</div><div>hostname test2</div><div>hostname</div><div>test2</div><div><br></div><div><br></div><div>2)挂载/卸载文件系统</div><div><br></div><div>这里我们注意,系统的mount命令不能做这个试验,因为程序中做了判断,如果不是root用户请退出.所以我们用mount()函数来完成这个试验,程序如下:</div><div><br></div><div>#include &lt;stdlib.h&gt;</div><div>#include &lt;sys/mount.h&gt;</div><div>int</div><div>main ()</div><div>{</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;int ret;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;ret = mount("/dev/sda1", "/mnt/", "ext3", MS_MGC_VAL, NULL);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if(ret &lt; 0){</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; perror("mount error");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 0;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;return 0;</div><div>}</div><div><br></div><div>用普通用户编译运行:</div><div>gcc mounttest.c -o mounttest</div><div>./mounttest&nbsp;</div><div>mount error: Operation not permitted</div><div><br></div><div>我们看到普通用户不能完成mount操作,而CAP_SYS_ADMIN可以帮助普通用户完成该操作,如下:</div><div><br></div><div>setcap cap_sys_admin=eip /home/test/mounttest&nbsp;</div><div><br></div><div><br></div><div>切换到普通用户,执行mounttest程序,如下:</div><div>./mounttest&nbsp;</div><div>cat /proc/mounts&nbsp;</div><div>略</div><div>/dev/sda1 /mnt ext3 rw,relatime,errors=remount-ro,barrier=0,data=writeback 0 0</div><div>umount和mount一样,我们在这里不做演示.</div><div><br></div><div><br></div><div>3)swapon/swapoff</div><div><br></div><div>普通用户不能进行swapon/swapoff操作,而CAP_SYS_ADMIN可以帮助普通用户完成swapon/swapoff操作,如下:</div><div>dd if=/dev/zero of=/tmp/testdb bs=10M count=1</div><div>1+0 records in</div><div>1+0 records out</div><div>10485760 bytes (10 MB) copied, 0.164669 s, 63.7 MB/s</div><div>/sbin/mkswap /tmp/testdb</div><div>Setting up swapspace version 1, size = 10481 kB</div><div>no label, UUID=0ff46dc8-781c-4c3f-81b3-fe860f74793e</div><div>/sbin/swapon /tmp/testdb</div><div>swapon: /tmp/testdb: Operation not permitted</div><div><br></div><div>我们看到swapon操作被拒绝,这里我们对swapon进行授权,如下:</div><div>setcap cap_sys_admin /sbin/swapon</div><div><br></div><div>普通用户再次swapon,如下:</div><div>/sbin/swapon /tmp/testdb</div><div>/sbin/swapon&nbsp;</div><div>/sbin/swapon -s</div><div>Filename &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Type &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Size &nbsp; &nbsp;Used &nbsp; &nbsp;Priority</div><div>/dev/sda6 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; partition &nbsp; &nbsp; &nbsp; 7815584 0 &nbsp; &nbsp; &nbsp; -1</div><div>/tmp/testdb &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10236 &nbsp; 0 &nbsp; &nbsp; &nbsp; -2</div><div>我们看到swapon操作成功.因为swapoff是swapon的软链接,所以可以直接swapoff掉交换分区,如下:</div><div>/sbin/swapoff /tmp/testdb</div><div>/sbin/swapon -s</div><div>Filename &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Type &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Size &nbsp; &nbsp;Used &nbsp; &nbsp;Priority</div><div>/dev/sda6 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; partition &nbsp; &nbsp; &nbsp; 7815584 0 &nbsp; &nbsp; &nbsp; -1</div><div>ls -l /sbin/swapoff &nbsp; &nbsp;</div><div>lrwxrwxrwx 1 root root 6 2009-08-23 07:49 /sbin/swapoff -&gt; swapon</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div>二十四) CAP_SYS_BOOT 22 (允许普通用使用reboot()函数)</div><div><br></div><div>这里我们无法用reboot命令来做测试,因为reboot命令做了判断,只允许root(UID=0)的用户可以使用.</div><div><br></div><div>我们用下面的程序进行测试.</div><div>#include &lt;unistd.h&gt;</div><div>#include &lt;sys/reboot.h&gt;</div><div>int main()</div><div>{</div><div>&nbsp;&nbsp; &nbsp;sync();&nbsp;</div><div>&nbsp;&nbsp; &nbsp;return reboot(RB_AUTOBOOT);</div><div>}</div><div><br></div><div>编译:</div><div>gcc reboot1.c -o reboot1</div><div>./reboot1</div><div>这时系统没有重启.</div><div><br></div><div>我们查看程序的返回码,这里是255,说明程序没有运行成功.</div><div>echo $?</div><div>255</div><div><br></div><div>我们用CAP_SYS_BOOT能力使reboot1程序可以被普通用户重启,如下:</div><div>setcap cap_sys_boot=eip /home/test/reboot1</div><div><br></div><div>用普通用户再试运行reboot1,如下:</div><div>reboot1</div><div><br></div><div>此时系统被重启了.</div><div><br></div><div><br></div><div><br></div><div><br></div><div>二十五)CAP_SYS_NICE 23(允许提升优先级,设置其它进程的优先级)</div><div><br></div><div>对于普通用户程序的NICE优先级,不能超过ulimit对它的限制,如下:</div><div>nice -n -5 ls&nbsp;</div><div>nice: cannot set niceness: Permission denied</div><div><br></div><div>而CAP_SYS_NICE可以帮助普通用户设置一个想要的一个任意优先级.</div><div>setcap cap_sys_nice=eip /usr/bin/nice</div><div><br></div><div>切换到普通用户,指定优先级,如下:</div><div>nice -n -5 ls&nbsp;</div><div>log &nbsp;mnt &nbsp;mount.c &nbsp;mounttest &nbsp;pacct &nbsp;psacct &nbsp;psacct.c &nbsp;reboot1 &nbsp;reboot1.c &nbsp;test</div><div><br></div><div>普通用户也不能给指定进程指定NICE优先级,而CAP_SYS_NICE也可以做的,如下:</div><div>renice -5 2255</div><div>renice: 2255: setpriority: Operation not permitted</div><div><br></div><div>setcap cap_sys_nice=eip /usr/bin/renice</div><div><br></div><div><br></div><div>renice -5 2255</div><div>2255: old priority 0, new priority -5</div><div><br></div><div>我们甚至可以用CAP_SYS_NICE来指定实时优先级</div><div>chrt -f 50 &nbsp;ls</div><div>chrt: failed to set pid 0's policy: Operation not permitted</div><div><br></div><div>给/usr/bin/chrt命令授权CAP_SYS_NICE能力,如下:</div><div>setcap &nbsp;cap_sys_nice=eip &nbsp;/usr/bin/chrt</div><div><br></div><div>切换到普通用户,如下:</div><div>chrt -f 50 &nbsp;ls</div><div>log &nbsp;mnt &nbsp;setulimit &nbsp;setulimit.c</div><div><br></div><div>我们也可以指定它的CPU亲和性,如下:</div><div>taskset -p 1 2255</div><div>pid 2255's current affinity mask: 1</div><div>sched_setaffinity: Operation not permitted</div><div>failed to set pid 2255's affinity.</div><div><br></div><div>给/usr/bin/taskset命令授权CAP_SYS_NICE能力,如下:</div><div>setcap &nbsp;cap_sys_nice=eip &nbsp;/usr/bin/taskset</div><div><br></div><div>切换到普通用户,再次运行taskset,可以成功的设置CPU亲和性</div><div>taskset -p 1 2255</div><div>pid 2255's current affinity mask: 1</div><div>pid 2255's new affinity mask: 1</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div>二十六) CAP_SYS_RESOURCE 24 忽略资源限制</div><div><br></div><div>普通用户不能用setrlimit()来突破ulimit的限制</div><div><br></div><div>我们用下面的程序进行测试,普通用户是无法修改RLIMIT_STACK(堆栈大小)的.如下:</div><div><br></div><div>#include &lt;signal.h&gt;</div><div>#include &lt;stdio.h&gt;</div><div>#include &lt;string.h&gt;</div><div>#include &lt;stdlib.h&gt;</div><div>#include &lt;limits.h&gt;</div><div>#include &lt;unistd.h&gt;</div><div>#include &lt;sys/types.h&gt;</div><div>#include &lt;sys/stat.h&gt;</div><div>#include &lt;sys/resource.h&gt;</div><div><br></div><div>int</div><div>main (int argc, char *argv[])</div><div>{</div><div>int r = 0;</div><div>struct rlimit rl;</div><div><br></div><div>getrlimit (RLIMIT_STACK,&amp;rl);</div><div><br></div><div>printf("crrent hard limit is %ld\n",</div><div>(u_long) rl.rlim_max);</div><div><br></div><div>rl.rlim_max = rl.rlim_max+1;</div><div>r = setrlimit (RLIMIT_STACK, &amp;rl);</div><div>if (r){</div><div>perror("setrlimit");</div><div>return -1;</div><div>}</div><div><br></div><div>printf("limit set to %ld \n", (u_long) rl.rlim_max+1);</div><div>return 0;</div><div>}</div><div><br></div><div>gcc setulimit.c -o setulimit</div><div><br></div><div>我们先来查看当前的限制,这里是10MB,如下:</div><div>ulimit -H -s&nbsp;</div><div>10240</div><div><br></div><div>./setulimit &nbsp; &nbsp;</div><div>crrent hard limit is 10485760</div><div>setrlimit: Operation not permitted</div><div><br></div><div>我们给setulimit程序以CAP_SYS_RESOURCE的能力,如下:</div><div>setcap cap_sys_resource=eip /home/test/setulimit&nbsp;</div><div><br></div><div>用普通用户再次运行程序,已经可以通过setrlimit()设定超过限额了,如下:</div><div>./setulimit&nbsp;</div><div>crrent hard limit is 10485760</div><div>limit set to 10485762&nbsp;</div><div><br></div><div><br></div><div>同样我们也可以用CAP_SYS_RESOURCE能力使程序超出磁盘限额,如下:</div><div><br></div><div>quotacheck -avug</div><div><br></div><div>quotaon -avug</div><div><br></div><div>edquota -u test</div><div><br></div><div>Filesystem &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; blocks &nbsp; &nbsp; &nbsp; soft &nbsp; &nbsp; &nbsp; hard &nbsp; &nbsp; inodes &nbsp; &nbsp; soft &nbsp; &nbsp; hard</div><div>&nbsp;&nbsp;/dev/sda7 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp;0</div><div><br></div><div>mkdir /export/test</div><div>chown -R test.test /export/test/</div><div><br></div><div>切换到普通用户,用dd命令产生3MB的文件,这明显超过了5kb的限制,如下:</div><div>su - test</div><div>dd if=/dev/zero of=/export/test/test bs=1M count=3</div><div>sda7: warning, user block quota exceeded.</div><div>sda7: write failed, user block limit reached.</div><div>dd: writing `test': Disk quota exceeded</div><div>1+0 records in</div><div>0+0 records out</div><div>4096 bytes (4.1 kB) copied, 0.0117371 s, 349 kB/s</div><div><br></div><div>授权CAP_SYS_RESOURCE能力给/bin/dd命令,如下:</div><div>setcap cap_sys_resource=eip /bin/dd</div><div><br></div><div><br></div><div>再次用普通用户运行dd命令,即可以超过5kb的限额了.</div><div>su - test</div><div>dd if=/dev/zero of=test bs=1M count=3</div><div>sda7: warning, user block quota exceeded.</div><div>3+0 records in</div><div>3+0 records out</div><div>3145728 bytes (3.1 MB) copied, 0.423662 s, 7.4 MB/s</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div>二十七)CAP_SYS_TIME 25(允许改变系统时钟)</div><div><br></div><div>普通用户不能改变系统时钟,如下:</div><div>date -s 2012-01-01</div><div>date: cannot set date: Operation not permitted</div><div>Sun Jan &nbsp;1 00:00:00 EST 2012</div><div><br></div><div>CAP_SYS_TIME可以帮助普通用户改变系统时钟,如下:</div><div>setcap cap_sys_time=eip /bin/date</div><div><br></div><div>切换到普通用户再次改变时间,发现已经可以改变了</div><div>su - test</div><div>date -s 2012-01-01</div><div>Sun Jan &nbsp;1 00:00:00 EST 2012</div><div>date</div><div>Sun Jan &nbsp;1 00:00:02 EST 2012</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div>二十八)CAP_SYS_TTY_CONFIG 26(允许配置TTY设备)</div><div><br></div><div>我们下面用vhangup()函数来挂起当前的tty</div><div>程序如下:</div><div>#include &lt;stdio.h&gt;</div><div>#include &lt;unistd.h&gt;</div><div><br></div><div>int main ()</div><div>{</div><div>&nbsp;&nbsp;int r;</div><div>&nbsp;&nbsp;r=vhangup();</div><div>&nbsp;&nbsp;if (r){&nbsp;</div><div>&nbsp;&nbsp;perror ("vhanguo");</div><div>&nbsp;&nbsp;}</div><div>&nbsp;&nbsp;return 0;</div><div>}</div><div><br></div><div>gcc vhup.c -o vhup</div><div><br></div><div>./vhup&nbsp;</div><div>vhanguo: Operation not permitted</div><div><br></div><div>我们给vhup程序设定CAP_SYS_TTY_CONFIG能力,如下:</div><div>setcap cap_sys_tty_config=eip /home/test/vhup</div><div><br></div><div><br></div><div>再次用普通用户执行程序vhup,tty被挂起,如下:</div><div>./vhup&nbsp;</div><div>此时当前tty被挂起.</div><div><br></div><div><br></div><div><br></div><div><br></div><div>二十九) CAP_MKNOD 27 (允许使用mknod系统调用)</div><div><br></div><div>普通用户不能用mknod()来创建设备文件,而CAP_MKNOD可以帮助普通用户做到这一点,如下:</div><div>mknod /tmp/tnod1 c 1 5</div><div>mknod: `/tmp/tnod1': Operation not permitted</div><div><br></div><div>setcap cap_mknod=eip /bin/mknod</div><div><br></div><div><br></div><div>切换到普通用户,再次用mknod命令创建设备文件,如下:</div><div>mknod /tmp/tnod1 c 1 5</div><div>ls -l /tmp/tnod1&nbsp;</div><div>crw-r--r-- 1 test test 1, 5 2012-01-01 00:31 /tmp/tnod1</div><div><br></div><div><br></div><div><br></div><div><br></div><div>三十) CAP_LEASE 28(允许在文件上建立租借锁)</div><div><br></div><div>系统调用fcntl()可以用于租借锁，此时采用的函数原型如下：</div><div><span class="Apple-tab-span" style="white-space:pre">	</span> &nbsp; &nbsp; &nbsp; int fcntl(int fd, int cmd, long arg);</div><div><br></div><div>与租借锁相关的 cmd 参数的取值有两种：F_SETLEASE 和 F_GETLEASE。其含义如下所示：</div><div>F_SETLEASE：根据下面所描述的 arg 参数指定的值来建立或者删除租约：</div><div>F_RDLCK：设置读租约。当文件被另一个进程以写的方式打开时，拥有该租约的当前进程会收到通知</div><div>F_WRLCK：设置写租约。当文件被另一个进程以读或者写的方式打开时，拥有该租约的当前进程会收到通知</div><div>F_UNLCK：删除以前建立的租约</div><div>F_GETLEASE：表明调用进程拥有文件上哪种类型的锁，这需要通过返回值来确定，返回值有三种：F_RDLCK、F_WRLCK和F_UNLCK，分别表明调用进程对文件拥有读租借、写租借或者根本没有租借</div><div>某个进程可能会对文件执行其他一些系统调用(比如 OPEN() 或者 TRUNCATE())，如果这些系统调用与该文件上由 F_SETLEASE 所设置的租借锁相冲突，内核就会阻塞这个系统调用；</div><div>同时，内核会给拥有这个租借锁的进程发信号，告知此事。拥有此租借锁的进程会对该信号进行反馈，它可能会删除这个租借锁，也可能会减短这个租借锁的租约，从而可以使得该文件可以被其他进程所访问。</div><div>如果拥有租借锁的进程不能在给定时间内完成上述操作，那么系统会强制帮它完成。通过 F_SETLEASE 命令将 arg 参数指定为 F_UNLCK 就可以删除这个租借锁。</div><div>不管对该租借锁减短租约或者干脆删除的操作是进程自愿的还是内核强迫的，只要被阻塞的系统调用还没有被发出该调用的进程解除阻塞，那么系统就会允许这个系统调用执行。</div><div>即使被阻塞的系统调用因为某些原因被解除阻塞，但是上面对租借锁减短租约或者删除这个过程还是会执行的。</div><div><br></div><div>源程序如下:</div><div>#define _GNU_SOURCE&nbsp;</div><div><br></div><div>#include &lt;unistd.h&gt;</div><div>#include &lt;fcntl.h&gt;</div><div>#include &lt;stdio.h&gt;</div><div>#include &lt;sys/file.h&gt;</div><div>static void show_lease(int fd)</div><div>{</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;int res;</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;res = fcntl(fd, F_GETLEASE);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;switch (res) {</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case F_RDLCK:</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;printf("Read lease\n");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case F_WRLCK:</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;printf("Write lease\n");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;case F_UNLCK:</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;printf("No leases\n");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default:</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;printf("Some shit\n");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;break;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div><div>}</div><div><br></div><div>int main(int argc, char **argv)</div><div>{</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;int fd, res;</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;fd = open(argv[1], O_RDONLY);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (fd == -1) {</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;perror("Can't open file");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return 1;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;res = fcntl(fd, F_SETLEASE, F_WRLCK);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (res == -1) {</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;perror("Can't set lease");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return 1;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;show_lease(fd);</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;if (flock(fd, LOCK_SH) == -1) {</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;perror("Can't flock shared");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return 1;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;show_lease(fd);</div><div><br></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;return 0;</div><div>}</div><div><br></div><div>编译:</div><div>gcc fcntl.c -o fcntl</div><div><br></div><div>我们使用普通用户在/etc/passwd文件上建立租借锁,由于普通用户没有/etc/passwd上建租借锁的权限,故而报错,如下:</div><div>su - test</div><div>/tmp/fcntl /etc/passwd</div><div>Can't set lease: Permission denied</div><div><br></div><div>注:</div><div>普通用户可以在自己的文件上(owner)建立租借锁.</div><div><br></div><div>授权lease给/tmp/fcntl文件,如下:</div><div>setcap cap_lease=eip /tmp/fcntl</div><div><br></div><div><br></div><div>再次运行/tmp/fcntl,可以建立租借锁了,如下:</div><div>/tmp/fcntl /etc/passwd</div><div>Write lease</div><div>Write lease</div><div><br></div><div><br></div><div><br></div><div>三十一)CAP_SETFCAP 31 (允许在指定的程序上授权能力给其它程序)</div><div><br></div><div>例如我们让普通用户也能用setcap给其它程序授权,如下:</div><div>setcap CAP_SETFCAP=eip /usr/sbin/setcap&nbsp;</div><div><br></div><div>su - test</div><div>setcap CAP_SETPCAP=eip /bin/ls</div><div><br></div><div>getcap /bin/ls &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div><div>/bin/ls = cap_setpcap+eip</div><div><br></div><div><br></div><div>三十二)其它的能力</div><div>CAP_AUDIT_WRITE</div><div>CAP_AUDIT_CONTROL</div><div>CAP_MAC_OVERRIDE</div><div>CAP_MAC_ADMIN</div><div>CAP_SYSLOG</div><div>这五组只能涉及到syslog,audit,mac等安全模块,以后专门对其进行分析.</div><div><br></div><div><br></div><div><br></div><div>三十三)总结:</div><div>CAP_CHOWN 0 允许改变文件的所有权&nbsp;</div><div>CAP_DAC_OVERRIDE 1 忽略对文件的所有DAC访问限制&nbsp;</div><div>CAP_DAC_READ_SEARCH 2 忽略所有对读、搜索操作的限制&nbsp;</div><div>CAP_FOWNER 3 以最后操作的UID,覆盖文件的先前的UID</div><div>CAP_FSETID 4 确保在文件被修改后不修改setuid/setgid位</div><div>CAP_KILL 5 允许对不属于自己的进程发送信号&nbsp;</div><div>CAP_SETGID 6 允许改变组ID&nbsp;</div><div>CAP_SETUID 7 允许改变用户ID&nbsp;</div><div>CAP_SETPCAP 8 允许向其它进程转移能力以及删除其它进程的任意能力(只限init进程)</div><div>CAP_LINUX_IMMUTABLE 9 允许修改文件的不可修改(IMMUTABLE)和只添加(APPEND-ONLY)属性&nbsp;</div><div>CAP_NET_BIND_SERVICE 10 允许绑定到小于1024的端口&nbsp;</div><div>CAP_NET_BROADCAST 11 允许网络广播和多播访问(未使用)&nbsp;</div><div>CAP_NET_ADMIN 12 允许执行网络管理任务：接口、防火墙和路由等.</div><div>CAP_NET_RAW 13 允许使用原始(raw)套接字&nbsp;</div><div>CAP_IPC_LOCK 14 允许锁定共享内存片段&nbsp;</div><div>CAP_IPC_OWNER 15 忽略IPC所有权检查&nbsp;</div><div>CAP_SYS_MODULE 16 插入和删除内核模块&nbsp;</div><div>CAP_SYS_RAWIO 17 允许对ioperm/iopl的访问&nbsp;</div><div>CAP_SYS_CHROOT 18 允许使用chroot()系统调用&nbsp;</div><div>CAP_SYS_PTRACE 19 允许跟踪任何进程&nbsp;</div><div>CAP_SYS_PACCT 20 允许配置进程记帐(process accounting)&nbsp;</div><div>CAP_SYS_ADMIN 21 允许执行系统管理任务：加载/卸载文件系统、设置磁盘配额、开/关交换设备和文件等.</div><div>CAP_SYS_BOOT 22 允许重新启动系统&nbsp;</div><div>CAP_SYS_NICE 23 允许提升优先级，设置其它进程的优先级&nbsp;</div><div>CAP_SYS_RESOURCE 24 忽略资源限制&nbsp;</div><div>CAP_SYS_TIME 25 允许改变系统时钟&nbsp;</div><div>CAP_SYS_TTY_CONFIG 26 允许配置TTY设备&nbsp;</div><div>CAP_MKNOD 27 允许使用mknod()系统调用&nbsp;</div><div>CAP_LEASE 28 允许在文件上建立租借锁</div><div>CAP_SETFCAP 31 允许在指定的程序上授权能力给其它程序</div><div><br></div><div>参考:</div><div>man capabilities</div><div>linux-2.6.38.5/include/linux/capability.h</div><div><br></div></div>
<div id="click_div"><table cellpadding="0" cellspacing="0" class="atd">
<tbody><tr><td>
<a href="http://home.lupaworld.com/home.php?mod=spacecp&ac=click&op=add&clickid=1&idtype=blogid&id=234972&hash=282ffd43a273ee5b3f641dcb8c398120&handlekey=clickhandle" id="click_blogid_234972_1" onclick="showWindow(this.id, this.href);doane(event);">
<img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/luguo.gif" alt=""><br>路过</a>
</td>
<td>
<a href="http://home.lupaworld.com/home.php?mod=spacecp&ac=click&op=add&clickid=2&idtype=blogid&id=234972&hash=282ffd43a273ee5b3f641dcb8c398120&handlekey=clickhandle" id="click_blogid_234972_2" onclick="showWindow(this.id, this.href);doane(event);">
<img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/leiren.gif" alt=""><br>雷人</a>
</td>
<td>
<a href="http://home.lupaworld.com/home.php?mod=spacecp&ac=click&op=add&clickid=3&idtype=blogid&id=234972&hash=282ffd43a273ee5b3f641dcb8c398120&handlekey=clickhandle" id="click_blogid_234972_3" onclick="showWindow(this.id, this.href);doane(event);">
<img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/woshou.gif" alt=""><br>握手</a>
</td>
<td>
<a href="http://home.lupaworld.com/home.php?mod=spacecp&ac=click&op=add&clickid=4&idtype=blogid&id=234972&hash=282ffd43a273ee5b3f641dcb8c398120&handlekey=clickhandle" id="click_blogid_234972_4" onclick="showWindow(this.id, this.href);doane(event);">
<img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/xianhua.gif" alt=""><br>鲜花</a>
</td>
<td>
<a href="http://home.lupaworld.com/home.php?mod=spacecp&ac=click&op=add&clickid=5&idtype=blogid&id=234972&hash=282ffd43a273ee5b3f641dcb8c398120&handlekey=clickhandle" id="click_blogid_234972_5" onclick="showWindow(this.id, this.href);doane(event);">
<img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/jidan.gif" alt=""><br>鸡蛋</a>
</td>
</tr>
</tbody></table>
<script type="text/javascript">
function errorhandle_clickhandle(message, values) {
if(values['id']) {
showCreditPrompt();
show_click(values['idtype'], values['id'], values['clickid']);
}
}
</script>

</div>
<div class="o cl">
<a href="http://home.lupaworld.com/home.php?mod=spacecp&ac=favorite&type=blog&id=234972&spaceuid=56821&handlekey=favoritebloghk_234972" id="a_favorite" onclick="showWindow(this.id, this.href, &#39;get&#39;, 0);" class="oshr ofav">收藏</a>
<a href="http://home.lupaworld.com/home.php?mod=spacecp&ac=share&type=blog&id=234972&handlekey=sharebloghk_234972" id="a_share" onclick="showWindow(this.id, this.href, &#39;get&#39;, 0);" class="oshr">分享</a>


<div class="wumii-hook"><div id="wumiiBtnDiv" style="clear:both;overflow:hidden;margin:0;padding:10px 0 0;text-shadow: none;text-indent:0;">
    <div id="wumiiLikeBtnDiv" style="position: static; float: left; display: inline; width: 89px; height: 28px; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; background-image: url(http://static.wumii.com/images/blogWidget/widget_buttons_deepBlue.png); background-attachment: initial; background-origin: initial; background-clip: initial; background-color: initial; text-indent: 0px; margin-left: 323px; background-position: 0px 0px; background-repeat: no-repeat no-repeat; " onmouseover="this.style.backgroundPosition=&#39;-89px 0&#39;;" onmouseout="this.style.backgroundPosition=&#39;0 0&#39;;">
        <span id="wumiiNumLikes" style="float:left;width:45px;height:19px;line-height:21px;*line-height:19px;margin:4px 0 0 0;padding:0;color:#385c80;letter-spacing:0;text-align:center;text-indent:0;font-size:12px;">0</span>
        <span style="float:left;width:40px;height:29px;margin:0;padding:0;outline:none;cursor:pointer;" id="wumiiLikeBtn" hidefocus="true"></span>
    </div>
    <div id="wumiiRecommendBtnDiv" style="position:static;clear:none;float:left;display:inline;height:28px;margin:0;padding:0 5px;text-indent:0;">
        <span id="wumiiRecommendBtn" hidefocus="true" style="float:left;display:inline;width:60px;height:28px;margin:0 0 0 5px;padding:0;background:url(&#39;http://static.wumii.com/images/blogWidget/widget_buttons_deepBlue.png&#39;) no-repeat -267px 0;cursor:pointer;outline:none;" onmouseover="this.style.backgroundPosition=&#39;-328px 0&#39;;" onmouseout="this.style.backgroundPosition=&#39;-267px 0&#39;;"></span>
        <img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/loading.gif" id="wumiiLoading" style="clear:none;display:none;height:15px;margin:7px 0 0 8px;padding:0;border:0;background:none;cursor:default;" alt="正在加载推荐文章">
    </div>
</div><div class="wumii-related-items-div" style="margin: 0; border: none; padding: 0; clear: both; overflow: hidden; *zoom: 1; *position: relative;">
    <div class="wumii-internal" style="padding: 0; margin: 0; border: none; clear: both; display: block;">
        <div class="wumii-widget-title" style="margin: 0; border: none; padding: 20px 0 5px; _padding-top:10px; text-indent: 0; text-align: left; font-weight: bold; ">您可能也喜欢：</div>
    <ul class="wumii-text-ul" style="padding: 0; margin: 0 0 0 1px;">
            <li class="wumii-text-li" style="list-style: disc inside none; display: list-item; line-height: 1.65em; background: none repeat scroll 0 0 transparent; padding: 0; margin: 0; text-indent: 0; text-align: left; font-size: 12px;">
                <a class="wumii-text-a" hidefocus="true" onmouseout="this.style.textDecoration=&#39;none&#39;" onmouseover="this.style.textDecoration=&#39;underline&#39;" href="http://home.lupaworld.com/home-space-uid-56821-do-blog-id-234956.html" onmousedown="this.href=&#39;http://app.wumii.com/ext/redirect.htm?url=http%3A%2F%2Fhome.lupaworld.com%2Fhome-space-uid-56821-do-blog-id-234956.html&amp;ts=&#39; + (new Date()).getTime() + &#39;&amp;from=http%3A%2F%2Fhome.lupaworld.com%2Fhome-space-uid-56821-do-blog-id-234972.html&#39; + &#39;&amp;ref=relatedItems&#39;; return true;" onmouseup="t=this; setTimeout(function() {t.href=&#39;http://home.lupaworld.com/home-space-uid-56821-do-blog-id-234956.html&#39;;}, 50); return true;" style="text-decoration: none; border-bottom: none; outline: none; color: #333333;"><span>《Linux的capability深入分析-上》</span></a>
            </li>
            <li class="wumii-text-li" style="list-style: disc inside none; display: list-item; line-height: 1.65em; background: none repeat scroll 0 0 transparent; padding: 0; margin: 0; text-indent: 0; text-align: left; font-size: 12px;">
                <a class="wumii-text-a" hidefocus="true" onmouseout="this.style.textDecoration=&#39;none&#39;" onmouseover="this.style.textDecoration=&#39;underline&#39;" href="http://home.lupaworld.com/home-space-uid-206688-do-blog-id-62783.html" onmousedown="this.href=&#39;http://app.wumii.com/ext/redirect.htm?url=http%3A%2F%2Fhome.lupaworld.com%2Fhome-space-uid-206688-do-blog-id-62783.html&amp;ts=&#39; + (new Date()).getTime() + &#39;&amp;from=http%3A%2F%2Fhome.lupaworld.com%2Fhome-space-uid-56821-do-blog-id-234972.html&#39; + &#39;&amp;ref=relatedItems&#39;; return true;" onmouseup="t=this; setTimeout(function() {t.href=&#39;http://home.lupaworld.com/home-space-uid-206688-do-blog-id-62783.html&#39;;}, 50); return true;" style="text-decoration: none; border-bottom: none; outline: none; color: #333333;"><span>linux总结</span></a>
            </li>
            <li class="wumii-text-li" style="list-style: disc inside none; display: list-item; line-height: 1.65em; background: none repeat scroll 0 0 transparent; padding: 0; margin: 0; text-indent: 0; text-align: left; font-size: 12px;">
                <a class="wumii-text-a" hidefocus="true" onmouseout="this.style.textDecoration=&#39;none&#39;" onmouseover="this.style.textDecoration=&#39;underline&#39;" href="http://home.lupaworld.com/home-space-uid-331886-do-blog-id-126045.html" onmousedown="this.href=&#39;http://app.wumii.com/ext/redirect.htm?url=http%3A%2F%2Fhome.lupaworld.com%2Fhome-space-uid-331886-do-blog-id-126045.html&amp;ts=&#39; + (new Date()).getTime() + &#39;&amp;from=http%3A%2F%2Fhome.lupaworld.com%2Fhome-space-uid-56821-do-blog-id-234972.html&#39; + &#39;&amp;ref=relatedItems&#39;; return true;" onmouseup="t=this; setTimeout(function() {t.href=&#39;http://home.lupaworld.com/home-space-uid-331886-do-blog-id-126045.html&#39;;}, 50); return true;" style="text-decoration: none; border-bottom: none; outline: none; color: #333333;"><span>Linux 核心（二）</span></a>
            </li>
            <li class="wumii-text-li" style="list-style: disc inside none; display: list-item; line-height: 1.65em; background: none repeat scroll 0 0 transparent; padding: 0; margin: 0; text-indent: 0; text-align: left; font-size: 12px;">
                <a class="wumii-text-a" hidefocus="true" onmouseout="this.style.textDecoration=&#39;none&#39;" onmouseover="this.style.textDecoration=&#39;underline&#39;" href="http://home.lupaworld.com/home-space-uid-434384-do-blog-id-245975.html" onmousedown="this.href=&#39;http://app.wumii.com/ext/redirect.htm?url=http%3A%2F%2Fhome.lupaworld.com%2Fhome-space-uid-434384-do-blog-id-245975.html&amp;ts=&#39; + (new Date()).getTime() + &#39;&amp;from=http%3A%2F%2Fhome.lupaworld.com%2Fhome-space-uid-56821-do-blog-id-234972.html&#39; + &#39;&amp;ref=relatedItems&#39;; return true;" onmouseup="t=this; setTimeout(function() {t.href=&#39;http://home.lupaworld.com/home-space-uid-434384-do-blog-id-245975.html&#39;;}, 50); return true;" style="text-decoration: none; border-bottom: none; outline: none; color: #333333;"><span>grep: /proc/xen/capabilities: No such file or directory</span></a>
            </li>
    </ul>
    </div>
        <div style="margin: 0; border: none; padding: 5px 0; clear: both; text-align: right;">
            <a href="http://www.wumii.com/widget/relatedItems.htm" target="_blank" title="无觅相关文章插件" style="font: normal normal normal 12px/normal arial; color: rgb(187, 187, 187); border-bottom-style: none; border-bottom-width: initial; border-bottom-color: initial; word-wrap: normal; display: inline; ">无觅</a>
            
        </div>
</div>

</div><span style="display:none;"><a rel="tag">Linux</a><a rel="tag">capability</a><a rel="tag">setcap</a></span>
<a href="javascript:void((function(s,d,e,r,l,p,t,z,c) {var%20f='http://v.t.sina.com.cn/share/share.php?appkey=1659826410',u=z||d.location,p=['&url=',e(u),'& title=',e(t||d.title),'&source=',e(r),'&sourceUrl=',e(l),'& content=',c||'gb2312','&pic=',e(p||'')].join('');function%20a() {if(!window.open([f,p].join(''),'mb', ['toolbar=0,status=0,resizable=1,width=440,height=430,left=',(s.width- 440)/2,',top=',(s.height-430)/2].join('')))u.href=[f,p].join('');}; if(/Firefox/.test(navigator.userAgent))setTimeout(a,0);else%20a();}) (screen,document,encodeURIComponent,'','','','《Linux的capability深入分析-下》','',''));" class="oshr" id="xwb_blog_mibicon" onclick="setTimeout(&#39;forstat()&#39;, 0);">转发到微博</a>
         <img id="statimg" style="display:none;">
         <script type="text/javascript">
            function forstat(){
                var statimg = document.getElementById("statimg");
                statimg.src = "http://beacon.x.weibo.com/a.gif?uid=&pjt=xwb4dx&dsz=1.5&ver=1.1&xt=fw&akey=1659826410&ip=202.118.236.184" + "&random=" + Math.round(Math.random()*1000000);
            }
         </script>
<a href="javascript:;" onclick="showWindow(&#39;miscreport234972&#39;, &#39;misc.php?mod=report&amp;rtype=blog&amp;rid=234972&#39;, &#39;get&#39;, -1);return false;">举报</a>
</div>

</div>

<div class="ct_vw cl">
<div class="ct_vw_sd">
<div class="mbm cl">
<h2 class="mbm ptn pbn bbs"><span class="xs1 xw0 y"><a href="http://home.lupaworld.com/home-space-uid-56821-do-blog-view-me.html">全部</a></span>作者的其他最新日志</h2>
<ul class="xl xl1 cl"><li>• <a href="http://home.lupaworld.com/home-space-uid-56821-do-blog-id-242388.html" target="_blank">《Linux下进程信息的深入分析》</a></li>
<li>• <a href="http://home.lupaworld.com/home-space-uid-56821-do-blog-id-242387.html" target="_blank">《Linux的CPU资源调优》</a></li>
<li>• <a href="http://home.lupaworld.com/home-space-uid-56821-do-blog-id-242320.html" target="_blank">《Linux的硬件时间及系统时间》</a></li>
<li>• <a href="http://home.lupaworld.com/home-space-uid-56821-do-blog-id-241652.html" target="_blank">《Linux keepalived与lvs的深入分析》</a></li>
<li>• <a href="http://home.lupaworld.com/home-space-uid-56821-do-blog-id-239185.html" target="_blank">《Linux下rsync服务的深入分析》</a></li>
<li>• <a href="http://home.lupaworld.com/home-space-uid-56821-do-blog-id-238537.html" target="_blank">《Linux下postfix服务的深入分析》</a></li>
</ul>
</div>
<div class="mbm cl">
<h2 class="mbm ptn pbn bbs">热门日志导读</h2>
<ul class="xl xl1 cl"><li><span class="xl1_elp">• <a href="http://home.lupaworld.com/home-space-uid-436999-do-blog-id-245844.html" target="_blank">一些让程序员伤心让程序员开心的话</a></span></li>
<li><span class="xl1_elp">• <a href="http://home.lupaworld.com/home-space-uid-26540-do-blog-id-245834.html" target="_blank">新一代弹性云计算平台cloudxy发布0.1版</a></span></li>
<li><span class="xl1_elp">• <a href="http://home.lupaworld.com/home-space-uid-439101-do-blog-id-244315.html" target="_blank">Linux系统下载网站----好东西</a></span></li>
<li><span class="xl1_elp">• <a href="http://home.lupaworld.com/home-space-uid-22802-do-blog-id-243602.html" target="_blank">用手机CPU搭建服务器</a></span></li>
<li><span class="xl1_elp">• <a href="http://home.lupaworld.com/home-space-uid-436905-do-blog-id-242981.html" target="_blank">12款高质量的免费 CSS 网站模板下载</a></span></li>
<li><span class="xl1_elp">• <a href="http://home.lupaworld.com/home-space-uid-328269-do-blog-id-242443.html" target="_blank">使用Java操作记事本</a></span></li>
</ul>
</div>
</div>

<div class="ct_vw_mn">
<div id="div_main_content" class="mbm">
<h3 class="ptn pbn bbs">
评论 (<span id="comment_replynum">0</span> 个评论)
</h3>
<div id="comment_ul" class="xld xlda"></div>
</div>
<form id="quickcommentform_234972" action="http://home.lupaworld.com/home.php?mod=spacecp&ac=comment" method="post" autocomplete="off" onsubmit="ajaxpost(&#39;quickcommentform_234972&#39;, &#39;return_qcblog_234972&#39;);doane(event);">
<p>
<span id="comment_face" title="插入表情" onclick="showFace(this.id, &#39;comment_message&#39;);return false;" style="cursor: pointer;"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/facelist.gif" alt="facelist" class="vm"></span>
</p>
<div class="tedt mtn mbn">
<div class="area">
<div class="pt hm">你需要登录后才可以评论 <a href="http://home.lupaworld.com/member.php?mod=logging&action=login" onclick="showWindow(&#39;login&#39;, this.href)" class="xi2">登录</a> | <a href="http://home.lupaworld.com/member.php?mod=luparegister21" onclick="showWindow(&#39;register&#39;, this.href)" class="xi2">注册</a></div>
</div>
</div>
<div class="mtm mbm sec">
<input name="sechash" type="hidden" value="Sb430">

验证问答 <span id="secqaaSb430" onclick="showMenu(this.id);"><input name="secanswer" id="secqaaverify_Sb430" type="text" autocomplete="off" style="width:100px" class="txt px vm" onblur="checksec(&#39;qaa&#39;, &#39;Sb430&#39;)" tabindex="1">
<a href="javascript:;" onclick="updatesecqaa(&#39;Sb430&#39;);doane(event);" class="xi2">换一个</a>
<span id="checksecqaaverify_Sb430"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/none.gif" width="16" height="16" class="vm"></span>
</span><div id="secqaaSb430_menu" class="p_pop p_opt" style="display:none"><span id="secqaa_Sb430" style=""><span style="cursor:pointer" class="xi2" onclick="updatesecqaa(&#39;Sb430&#39;)">刷新验证问答</span></span>
<script type="text/javascript" reload="1">updatesecqaa('Sb430');</script>
</div>

</div>
<p class="pns">
<input type="hidden" name="referer" value="home.php?mod=space&amp;uid=56821&amp;do=blog&amp;id=234972">
<input type="hidden" name="id" value="234972">
<input type="hidden" name="idtype" value="blogid">
<input type="hidden" name="handlekey" value="qcblog_234972">
<input type="hidden" name="commentsubmit" value="true">
<input type="hidden" name="quickcomment" value="true">
<button type="submit" name="commentsubmit_btn" value="true" id="commentsubmit_btn" class="pn" onclick="showWindow(this.id, this.form.action);return false;"><strong>评论</strong></button>
<span id="return_qcblog_234972"></span>
</p>
<input type="hidden" name="formhash" value="b967f47c">
</form>
<script type="text/javascript">
function succeedhandle_qcblog_234972(url, msg, values) {
if(values['cid']) {
comment_add(values['cid']);
} else {
$('return_qcblog_234972').innerHTML = msg;
}
updatesecqaa('Sb430');
}
</script>

<script type="text/javascript">
function addFriendCall(){
var el = $('friendinput');
if(!el || el.value == "")	return;
var s = '<input type="checkbox" name="fusername[]" class="pc" value="'+el.value+'" id="'+el.value+'" checked="checked">';
s += ' <label for="'+el.value+'">'+el.value+'</label>';
s += '<br />';
$('friends').innerHTML += s;
el.value = '';
}
resizeImg('div_main_content','450');

var elems = selector('dd[class~=magicflicker]');
for(var i=0; i<elems.length; i++){
magicColor(elems[i]);
}
</script>

</div>
</div>

</div>
<!--[diy=diycontentbottom]--><div id="diycontentbottom" class="area"></div><!--[/diy]-->
</div>
<div class="appl"><ul><li><a href="http://home.lupaworld.com/home-space-do-doing.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/doing.gif" width="16" height="16">微博</a></li><li><a href="http://www.lupaworld.com/plugin.php?id=luckypost:luckypost" title="发帖际遇"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/bgpic.gif" width="16" height="16">际遇</a></li><li><span><a href="http://home.lupaworld.com/forum.php?mod=misc&action=nav&special=0&" onclick="showWindow(&#39;nav&#39;, this.href);return false;">发布</a></span><a href="http://home.lupaworld.com/home-space-do-thread.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/thread.gif" width="16" height="16">帖子</a></li><li><span><a href="http://home.lupaworld.com/home-spacecp-ac-blog.html">发布</a></span><a href="http://home.lupaworld.com/home-space-do-blog.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/blog.gif" width="16" height="16">日志</a></li><li><span><a href="http://home.lupaworld.com/home-spacecp-ac-upload.html">上传</a></span><a href="http://home.lupaworld.com/home-space-do-album.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/album.gif" width="16" height="16">相册</a></li><li><span><a href="http://home.lupaworld.com/home.php?mod=spacecp&ac=share" onclick="showWindow(&#39;share&#39;, this.href, &#39;get&#39;, 0);return false;">添加</a></span><a href="http://home.lupaworld.com/home-space-do-share.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/share.gif" width="16" height="16">分享</a></li><li><span><a href="http://home.lupaworld.com/home-spacecp-ac-tv.html">添加</a></span><a href="http://home.lupaworld.com/home-tv.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/activitysmall.gif" width="16" height="16">视频</a></li><li><a href="http://home.lupaworld.com/home-task-item-new.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/debatesmall.gif" width="16" height="16">小任务</a></li></ul><hr class="da"><ul><li><a href="http://home.lupaworld.com/home-space-do-favorite.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/favorite.gif" width="16" height="16">收藏</a></li><li><a href="http://home.lupaworld.com/home-medal.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/medal.gif" width="16" height="16">勋章</a></li><li><a href="http://home.lupaworld.com/home-spacecp-ac-credit-op-base.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/rewardsmall.gif" width="16" height="16">积分</a></li></ul><hr class="da"><ul></ul>
<ul id="my_defaultapp"><li><a href="http://www.lupaworld.com/userapp-app-id-1021978.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/1021978" onerror="this.onerror=null;this.src=&#39;http://appicon.manyou.com/icons/1021978&#39;" alt="开心农场">开心农场</a></li>
<li><a href="http://www.lupaworld.com/userapp-app-id-1047370.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/1047370" onerror="this.onerror=null;this.src=&#39;http://appicon.manyou.com/icons/1047370&#39;" alt="地产大亨">地产大亨</a></li>
<li><a href="http://www.lupaworld.com/userapp-app-id-1003049.html"><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/1003049.jpg" onerror="this.onerror=null;this.src=&#39;http://appicon.manyou.com/icons/1003049&#39;" alt="每天进步">每天进步</a></li>
</ul>
<script type="text/javascript">inituserabout();</script></div>
</div>

<div class="wp mtn">
<!--[diy=diy3]--><div id="diy3" class="area"></div><!--[/diy]-->
</div>

﻿	</div>

<p style="margin:0;padding:0;height:1px;">
    <script type="text/javascript"><!--
        var wumiiSitePrefix = "http://home.lupaworld.com/";
        var wumiiEnableCustomPos = false;
        var wumiiParams = "&num=4&mode=3&v=1.0.1.1&pf=DiscuzX1.5";
    //--></script>
    <script id="wumiiRelatedItems" type="text/javascript" src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/relatedItemsWidget.htm"></script>
    <a href="http://www.wumii.com/widget/relatedItems.htm" style="border:0;">
        <img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/pixel.png" alt="无觅相关文章插件" style="border:0;padding:0;margin:0;">
    </a>
</p><script language="javascript">
var _xwb_cfg_data ={
	tipsType:	'',site_uid:	'0',sina_uid:	'',
	siteVer:	'1.5',siteName:	'LUPA开源社区',pName:'home_space',
	regUrl:		'/xwb.php?m=xwbSiteInterface.reg',
	setUrl:		'/xwb.php?m=xwbSiteInterface.bind',
	bindUrl:	'/xwb.php?m=xwbSiteInterface.bind',
	signerUrl:	'/xwb.php?m=xwbSiteInterface.signer',
	authUrl:	'/xwb.php?m=xwbAuth.login',
	getTipsUrl:	'/xwb.php?m=xwbSiteInterface.getTips',
	attentionUrl:	'/xwb.php?m=xwbSiteInterface.attention',
	wbxUrl:		'http://service.t.sina.com.cn/widget/WeiboShow.php?uname=xweibo%E6%B5%8B%E8%AF%95%E5%B8%90%E5%8F%B7&width=180&height=500&skin=2&isTitle=1&isWeibo=1&isFans=1&fansRow=7&__noCache=1304603850328'
};

function xwb_loadScript(file, charset){
	var script = document.createElement('SCRIPT');
	script.type = 'text/javascript'; script.charset = charset; script.src = file;
	document.getElementsByTagName('HEAD')[0].appendChild(script);
}
xwb_loadScript("http://home.lupaworld.com/xwb/images/dlg.js", "UTF-8");
xwb_loadScript("http://home.lupaworld.com/xwb/images/xwb.js", "UTF-8");
</script>
<link href="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/xwb_base.css" rel="stylesheet" type="text/css">
<link href="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/xwb_1.5.css" rel="stylesheet" type="text/css">
<div id="ft" class="wp cl">
<div id="flk" class="y">
<p><a href="http://www.lupaworld.com/misc-faq.html">社区帮助</a><span class="pipe">|</span><a href="http://bbs.lupaworld.com/forum-332-1.html">留言反馈</a><span class="pipe">|</span><a href="http://bbs.lupaworld.com/forum.php?archiver=1">Archiver</a><span class="pipe">|</span><a href="http://t.sina.com.cn/lupaworld">LUPA新浪微博</a><span class="pipe">|</span><a href="http://www.lupaworld.com/portal-list-catid-245.html">关于我们</a><span class="pipe">|</span><strong><a href="http://www.lupaworld.com/" target="_blank">LUPA</a></strong>
( <a href="http://www.miitbeian.gov.cn/" target="_blank">浙ICP备09009928号</a> )</p><div style="display:none">
<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/stat.php" language="JavaScript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=1360480" target="_blank" title="站长统计">站长统计</a><img src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/stat.htm" border="0" width="0" height="0">
</div>
<script type="text/javascript" src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/jiathis_r.js" charset="utf-8"></script><script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/ckepop.js" charset="utf-8"></script><script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/ckecenterpop.js" charset="utf-8"></script>				
<p></p>
<p class="xs0">
GMT+8, 2011-12-7 10:16<span id="debuginfo">
, Processed in 0.089458 second(s), 20 queries
.
</span> <b>开源</b>支持
</p>
<h1>浙江科华科技发展有限公司旗下站点--LUPA开源社区</h1>
</div>
<div id="frt">
<p>Powered by <strong><a href="http://www.lupaworld.com/" target="_blank">LUPA</a>，基于Discuz X1.5修改。</strong></p><strong> 
<p class="xs0">© 2005-2011 </p>  
<a href="http://www.lupaworld.com/"><h1>开源社区</h1></a>
</strong></div><strong></strong></div><strong>

<ul id="usersetup_menu" class="p_pop" style="display:none;">
<li><a href="http://home.lupaworld.com/home-spacecp-ac-avatar.html">修改头像</a></li>
<li><a href="http://home.lupaworld.com/home-spacecp-ac-profile.html">个人资料</a></li>
<li><a href="http://home.lupaworld.com/home-spacecp-ac-credit.html">积分</a></li>
<li><a href="http://home.lupaworld.com/home-spacecp-ac-usergroup.html">用户组</a></li>
<li><a href="http://home.lupaworld.com/home-spacecp-ac-privacy.html">隐私筛选</a></li>
<li><a href="http://home.lupaworld.com/home-spacecp-ac-sendmail.html">邮件提醒</a></li>
<li><a href="http://home.lupaworld.com/home-spacecp-ac-profile-op-password.html">密码安全</a></li>
<li><a href="http://home.lupaworld.com/home-spacecp-ac-plugin-id-myrepeats%3Amemcp.html">我的马甲</a></li><li><a href="http://home.lupaworld.com/home-spacecp-ac-plugin-id-sina_xweibo%3Ahome_binding.html">绑定新浪微博</a></li></ul>

<div id="g_upmine_menu" class="g_up" style="display:none;">
<div class="crly">
积分 0, 距离下一级还需  积分
</div>
<div class="mncr"></div>
</div>
<script src="./《Linux的capability深入分析-下》 - ckhitler的日志 LUPA开源社区_files/home.php" type="text/javascript"></script>

</strong></body></html>